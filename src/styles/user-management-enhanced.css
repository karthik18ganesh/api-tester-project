/* Enhanced User Management Styles - FIXED */

/* Form Input Enhancements */
.enhanced-input {
  @apply w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm transition-all duration-300;
}

.enhanced-input:focus {
  @apply transform scale-[1.02] shadow-lg;
}

.enhanced-input:hover {
  @apply border-gray-300 shadow-md;
}

/* Modern Form Input Styles */
.modern-input {
  @apply w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm transition-all duration-300;
}

.modern-input:focus {
  @apply outline-none border-indigo-500 ring-2 ring-indigo-200 shadow-md;
}

.modern-input:hover {
  @apply border-gray-300;
}

.modern-input:focus-within {
  @apply border-indigo-500;
}

/* Input with Icons */
.input-with-icon {
  @apply pl-10 pr-4;
}

.input-icon {
  @apply absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none;
}

/* FIXED: Prevent input focus loss */
input:focus {
  @apply outline-none;
}

/* FIXED: Ensure input focus is maintained */
input:focus-visible {
  @apply outline-none ring-2 ring-indigo-500 ring-offset-2;
}

/* FIXED: Prevent form re-rendering from affecting focus */
.form-input-stable {
  @apply transition-none;
  /* Disable all transitions during focus to prevent re-render focus loss */
  transition: none !important;
}

.form-input-stable:focus {
  @apply transition-none;
  /* Keep transitions disabled during focus */
  transition: none !important;
  /* Ensure focus is maintained */
  outline: none !important;
}

/* FIXED: Enhanced input container to maintain focus */
.input-container {
  @apply relative;
  /* Ensure container doesn't interfere with input focus */
  pointer-events: none;
}

.input-container input {
  /* Re-enable pointer events for the input */
  pointer-events: auto;
}

.input-container:focus-within {
  @apply ring-2 ring-indigo-200 rounded-xl;
}

/* Enhanced focus management */
.form-input-stable:focus {
  /* Override any conflicting styles */
  transform: none !important;
  transition: none !important;
  animation: none !important;
}

/* Permission Card Styles */
.permission-card {
  @apply bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm;
  transition: box-shadow 0.2s ease-in-out;
}

.permission-card:hover {
  @apply shadow-md;
}

.permission-card-header {
  @apply bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-4 border-b border-gray-200;
}

.permission-section {
  @apply p-6 space-y-4;
}

.permission-section-item {
  @apply flex items-center space-x-3 p-3 rounded-lg transition-colors cursor-pointer;
}

.permission-section-item:hover {
  @apply bg-gray-50;
}

/* FIXED: Button visibility and responsiveness */
.modal-actions {
  @apply flex justify-end space-x-4 pt-6 border-t border-gray-200;
  /* Ensure buttons are always visible */
  min-height: 60px;
  position: relative;
  z-index: 10;
}

/* FIXED: Responsive button layout */
@media (max-width: 640px) {
  .modal-actions {
    @apply flex-col space-x-0 space-y-3;
  }
  
  .modal-actions .btn {
    @apply w-full;
  }
}

@media (min-width: 641px) {
  .modal-actions {
    @apply flex-row space-y-0 space-x-4;
  }
  
  .modal-actions .btn {
    @apply w-auto;
  }
}

/* FIXED: Ensure buttons are always visible in desktop view */
.permission-modal-buttons {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
  z-index: 100 !important;
}

/* FIXED: Desktop specific button styles */
@media (min-width: 768px) {
  .permission-modal-buttons {
    flex-direction: row !important;
    justify-content: flex-end !important;
    gap: 1rem !important;
  }
  
  .permission-modal-buttons button {
    min-width: 120px !important;
    display: inline-flex !important;
    visibility: visible !important;
  }
}

/* FIXED: Mobile specific button styles */
@media (max-width: 767px) {
  .permission-modal-buttons {
    flex-direction: column !important;
    gap: 0.75rem !important;
  }
  
  .permission-modal-buttons button {
    width: 100% !important;
  }
}

/* Enhanced button base styles */
.enhanced-button {
  @apply px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-300 flex items-center justify-center space-x-2 shadow-md hover:shadow-lg;
}

.enhanced-button:hover {
  @apply transform -translate-y-0.5;
}

.enhanced-button:focus {
  @apply outline-none ring-2 ring-offset-2;
}

.enhanced-button:disabled {
  @apply opacity-50 cursor-not-allowed transform-none;
}

/* Enhanced select styles */
.enhanced-select {
  @apply w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm transition-all duration-300 hover:border-gray-300;
}

/* FIXED: Checkbox styles for permissions */
.permission-checkbox {
  @apply rounded border-gray-300 text-indigo-600 focus:ring-indigo-500;
  /* Ensure checkbox interactions work properly */
  pointer-events: auto !important;
  cursor: pointer !important;
}

.permission-checkbox:checked {
  @apply bg-indigo-600 border-indigo-600;
}

.permission-checkbox:focus {
  @apply ring-2 ring-indigo-500 ring-offset-2;
}

/* FIXED: Label styles for permissions */
.permission-label {
  @apply flex items-center space-x-3 cursor-pointer;
  /* Ensure labels are clickable */
  pointer-events: auto !important;
  user-select: none;
}

.permission-label:hover {
  @apply bg-gray-50;
}

/* User Avatar Styles */
.user-avatar {
  @apply h-12 w-12 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold text-lg shadow-lg;
}

.user-avatar-small {
  @apply h-8 w-8 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm shadow-md;
}

/* Status Indicators */
.status-active {
  @apply bg-green-100 text-green-800 border-green-200;
}

.status-inactive {
  @apply bg-red-100 text-red-800 border-red-200;
}

/* Role Badge Enhancements */
.role-badge {
  @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border-2 transition-all duration-200;
}

.role-badge:hover {
  @apply transform scale-105 shadow-md;
}

/* Form Validation Styles */
.form-input-error {
  @apply border-red-300 focus:border-red-500 focus:ring-red-200;
}

.form-input-success {
  @apply border-green-300 focus:border-green-500 focus:ring-green-200;
}

/* FIXED: Modal specific styles to prevent button hiding */
.modal-content {
  /* Ensure modal content doesn't hide buttons */
  position: relative;
  z-index: 1;
}

.modal-body {
  /* Prevent modal body from overlapping buttons */
  padding-bottom: 2rem;
}

.modal-footer {
  /* Ensure footer is always visible */
  position: relative;
  z-index: 10;
  background: white;
  border-top: 1px solid #e5e7eb;
  padding: 1.5rem;
  margin-top: auto;
}

/* FIXED: Permission grid layout */
.permission-grid {
  @apply grid gap-6;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
}

@media (min-width: 1024px) {
  .permission-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 1023px) {
  .permission-grid {
    grid-template-columns: 1fr;
  }
}

/* FIXED: Ensure permission sections are interactive */
.permission-section-content {
  /* Ensure all permission elements are interactive */
  pointer-events: auto;
}

.permission-section-content input[type="checkbox"] {
  /* Ensure checkboxes are always clickable */
  pointer-events: auto !important;
  cursor: pointer !important;
  z-index: 2;
  position: relative;
}

.permission-section-content label {
  /* Ensure labels are clickable */
  cursor: pointer !important;
  pointer-events: auto !important;
}

/* Responsive Enhancements */
@media (max-width: 768px) {
  .enhanced-input {
    @apply px-3 py-2 text-sm;
  }
  
  .enhanced-button {
    @apply px-4 py-2 text-sm;
  }
  
  .user-avatar {
    @apply h-10 w-10 text-base;
  }
}

/* FIXED: Dark Mode Support */
@media (prefers-color-scheme: dark) {
  .enhanced-input {
    @apply bg-gray-800 border-gray-600 text-white;
  }
  
  .enhanced-select {
    @apply bg-gray-800 border-gray-600 text-white;
  }
  
  .permission-card {
    @apply bg-gray-800 border-gray-600;
  }
  
  .permission-card-header {
    @apply bg-gray-700 border-gray-600;
  }
}

/* FIXED: Focus trap prevention */
.form-container {
  /* Prevent focus trapping issues */
  isolation: isolate;
}

.form-field {
  /* Ensure each form field maintains focus independently */
  position: relative;
  z-index: 1;
}

/* FIXED: Animation performance */
.form-input-stable {
  /* Disable GPU acceleration that might cause focus issues */
  transform: translateZ(0);
  will-change: auto;
  backface-visibility: visible;
}

/* FIXED: Safari specific fixes */
@supports (-webkit-appearance: none) {
  .form-input-stable {
    -webkit-appearance: none;
    -webkit-transform: translateZ(0);
    -webkit-backface-visibility: visible;
  }
}

/* FIXED: Firefox specific fixes */
@-moz-document url-prefix() {
  .form-input-stable {
    -moz-appearance: none;
  }
  
  .permission-checkbox {
    -moz-appearance: none;
  }
}