import{j as e}from"./chunk-xjDKe2wf.js";import{r as t}from"./chunk-D8-U-K1F.js";import{F as r,a as s,b as n,c as i,d as a,e as o,f as l,g as d}from"../assets/index-OFcpw0jO.js";import{y as c}from"./chunk-CALic51h.js";import{n as m}from"./chunk-BV3C3NLD.js";import{B as x}from"./chunk-Dw3wbBjo.js";import{B as g,I as h}from"./chunk-Bnx7RstE.js";import"./chunk-SnPUoUoO.js";import"./chunk-SIvHljHK.js";const u=()=>{const[u,p]=t.useState([]),[b,v]=t.useState({id:null,environmentName:"",environmentUrl:"",description:""}),[y,j]=t.useState(1),[f,N]=t.useState(!1),[w,C]=t.useState(null),[k,S]=t.useState(!0),[U,D]=t.useState(!1),[E,I]=t.useState(""),L=null!==b.id,M=u.filter((e=>e.environmentName.toLowerCase().includes(E.toLowerCase())||e.environmentUrl.toLowerCase().includes(E.toLowerCase())||e.description?.toLowerCase().includes(E.toLowerCase()||""))),F=Math.ceil(M.length/6),z=M.slice(6*(y-1),6*y),B=async()=>{D(!0);try{const e=await d("/api/v1/environments?pageNo=0&limit=100&sortBy=updatedDate&sortDir=DESC","GET"),{code:t,message:r,data:s}=e.result;if("200"===t){const e=s.content.map((e=>({id:e.environmentId,environmentName:e.environmentName,environmentUrl:e.environmentUrl,description:e.description,date:e.createdDate,updatedDate:e.updatedDate,environmentId:e.environmentId,project:e.project})));p(e)}else c.error(r||"Failed to fetch environments")}catch(e){c.error("Error fetching environments")}finally{D(!1)}},T=()=>{v({id:null,environmentName:"",environmentUrl:"",description:""})};return t.useEffect((()=>{B()}),[]),e.jsxs("div",{className:"p-6 text-gray-800 font-inter",children:[e.jsx(x,{items:[{label:"Admin Settings"},{label:"Environment Setup"}]}),e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Environment Setup"})}),e.jsxs("div",{id:"environmentForm",className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden transition-all duration-300 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 px-6 py-4 flex justify-between items-center cursor-pointer",onClick:()=>S(!k),children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx(r,{className:"text-indigo-200"}),L?"Update Environment":"Create New Environment"]}),e.jsx(s,{className:"text-white transition-transform duration-300 transform "+(k?"rotate-180":"")})]}),e.jsx("div",{className:"transition-all duration-300 overflow-hidden "+(k?"max-h-[500px] opacity-100":"max-h-0 opacity-0"),children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),D(!0);const t={requestMetaData:{userId:localStorage.getItem("userId"),transactionId:m(),timestamp:(new Date).toISOString()},data:{environmentId:L?b.id:void 0,environmentName:b.environmentName,environmentUrl:b.environmentUrl,description:b.description}};L||delete t.data.environmentId;const r=L?"PUT":"POST";try{const e=await d("/api/v1/environments",r,t),{code:s,message:n}=e.result;"200"===s?(c.success(n||(L?"Updated successfully":"Created successfully")),B(),T()):c.error(n||"Failed to process request")}catch(s){c.error("Something went wrong")}finally{D(!1)}},className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Environment Name"}),e.jsx("input",{type:"text",value:b.environmentName,onChange:e=>v((t=>({...t,environmentName:e.target.value}))),className:"w-full border border-gray-300 p-3 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",placeholder:"e.g. Development, Staging, Production",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Environment URL"}),e.jsx("input",{type:"text",value:b.environmentUrl,onChange:e=>v((t=>({...t,environmentUrl:e.target.value}))),className:"w-full border border-gray-300 p-3 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",placeholder:"https://api.example.com",required:!0})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Description"}),e.jsx("textarea",{rows:3,value:b.description,onChange:e=>v((t=>({...t,description:e.target.value}))),className:"w-full border border-gray-300 p-3 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",placeholder:"Describe this environment's purpose and usage"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[L&&e.jsx("button",{type:"button",onClick:T,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx(g,{type:"submit",className:"flex items-center gap-2",disabled:U,children:U?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):L?"Update Environment":"Create Environment"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50 flex flex-col md:flex-row justify-between md:items-center gap-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Environments"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(n,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Search environments...",value:E,onChange:e=>{I(e.target.value),j(1)}}),E&&e.jsx("button",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>I(""),children:e.jsx(i,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),U&&0===u.length?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[e.jsx("div",{className:"h-8 w-8 bg-indigo-200 rounded-full mb-4",children:e.jsxs("svg",{className:"animate-spin h-8 w-8 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading environments..."})]})}):0===z.length?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-3 mb-4",children:e.jsx(r,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No environments found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:E?`No environments matching "${E}"`:"Start by creating your first environment"}),E&&e.jsxs(g,{onClick:()=>I(""),className:"flex items-center gap-2",children:[e.jsx(i,{size:14}),e.jsx("span",{children:"Clear Search"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:z.map((t=>{const r=(e=>{const t=e.toLowerCase();return t.includes("prod")?{label:"Production",bgColor:"bg-red-100",textColor:"text-red-800"}:t.includes("stage")||t.includes("staging")?{label:"Staging",bgColor:"bg-yellow-100",textColor:"text-yellow-800"}:t.includes("dev")?{label:"Development",bgColor:"bg-green-100",textColor:"text-green-800"}:t.includes("test")||t.includes("qa")||t.includes("uat")?{label:"Testing",bgColor:"bg-blue-100",textColor:"text-blue-800"}:t.includes("sandbox")?{label:"Sandbox",bgColor:"bg-purple-100",textColor:"text-purple-800"}:t.includes("integration")?{label:"Integration",bgColor:"bg-indigo-100",textColor:"text-indigo-800"}:t.includes("demo")?{label:"Demo",bgColor:"bg-teal-100",textColor:"text-teal-800"}:{label:"Other",bgColor:"bg-gray-100",textColor:"text-gray-800"}})(t.environmentName);return e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.bgColor} ${r.textColor}`,children:r.label}),e.jsx("h4",{className:"font-medium text-gray-900 truncate",children:t.environmentName})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(h,{icon:a,onClick:()=>{return v({id:(e=t).id,environmentName:e.environmentName,environmentUrl:e.environmentUrl,description:e.description}),S(!0),void document.getElementById("environmentForm").scrollIntoView({behavior:"smooth"});var e},className:"bg-indigo-100 hover:bg-indigo-200 rounded-md text-indigo-600"}),e.jsx(h,{icon:o,onClick:()=>{C(t),N(!0)},className:"bg-red-100 hover:bg-red-200 rounded-md text-red-600"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"URL"}),e.jsx(h,{icon:l,onClick:()=>{return e=t.environmentUrl,void navigator.clipboard.writeText(e).then((()=>{c.success("URL copied to clipboard!")}),(()=>{c.error("Failed to copy URL")}));var e},className:"text-gray-400 hover:text-indigo-600",title:"Copy URL"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 overflow-hidden overflow-ellipsis",children:t.environmentUrl}),t.description&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:t.description})]}),e.jsxs("div",{className:"mt-4 text-xs text-gray-400 flex justify-between",children:[e.jsxs("span",{children:["Created: ",t.date]}),t.updatedDate&&t.updatedDate!==t.date&&e.jsxs("span",{children:["Updated: ",t.updatedDate]})]})]})]},t.id)}))}),e.jsxs("div",{className:"flex justify-between items-center px-4 py-4 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",Math.min(M.length,6*(y-1)+1)," to"," ",Math.min(M.length,6*y)," of ",M.length," environments"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>j((e=>Math.max(e-1,1))),disabled:1===y,className:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-40 disabled:hover:bg-white text-gray-700 transition-colors",children:"Prev"}),(()=>{const e=[];e.push(1),y>4&&e.push("...");for(let t=Math.max(2,y-2);t<=Math.min(F-1,y+2);t++)e.push(t);return y+2<F-1&&e.push("..."),F>1&&e.push(F),e})().map(((t,r)=>e.jsx("button",{disabled:"..."===t,onClick:()=>"..."!==t&&j(t),className:`px-3 py-1 border rounded-md ${t===y?"bg-indigo-600 text-white border-indigo-600":"border-gray-300 hover:bg-gray-100 text-gray-700"} transition-colors`,children:t},r))),e.jsx("button",{onClick:()=>j((e=>Math.min(e+1,F))),disabled:y===F||0===F,className:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-40 disabled:hover:bg-white text-gray-700 transition-colors",children:"Next"})]})]})]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:()=>N(!1),children:e.jsx("div",{className:"absolute inset-0 bg-gray-900 opacity-50"})}),e.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-xl transform transition-all max-w-lg w-full p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:e.jsx(o,{className:"h-6 w-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2 text-center",children:"Delete Environment"}),e.jsxs("p",{className:"text-gray-600 text-center",children:["Are you sure you want to delete ",e.jsxs("span",{className:"font-medium text-gray-900",children:['"',w?.environmentName,'"']}),"? This action cannot be undone."]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>N(!1),children:"Cancel"}),e.jsx(g,{onClick:async()=>{D(!0);try{const e=await d(`/api/v1/environments/${w.id}`,"DELETE"),{code:t,message:r}=e.result;"200"===t?(c.success(r||"Environment deleted"),B()):c.error(r||"Failed to delete")}catch(e){c.error("Error deleting environment")}finally{D(!1),N(!1)}},className:"bg-red-600 hover:bg-red-700",disabled:U,children:U?e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete"})]})]})]})})]})};export{u as default};
