import{j as e}from"./chunk-BAZEzdRI.js";import{r as s,u as t}from"./chunk-N8EMqdL-.js";import{a0 as a,a1 as r,a2 as n,a3 as i,I as l,a4 as d,a5 as c,a6 as o,F as x,a7 as m,a8 as u,a9 as h,aa as g,ab as b,ac as j,ad as p,ae as N,af as f,ag as y,a as v,c as w,ah as S,ai as C,J as k,r as E,v as T,aj as R,ak as I,t as q,al as D,am as P,an as $,O as A,u as B,ao as M,g as O,Z as F,ap as L}from"../assets/index-C0OMGUoK.js";import{y as U}from"./chunk-CQIvISRI.js";import{A as V}from"./chunk-y15rfk2T.js";import{g as W,a as G,b as z}from"./chunk-DvM4gKK_.js";import{B as H}from"./chunk-C_F5Bpmt.js";import{M as _,B as J}from"./chunk-D8tE5vCa.js";import"./chunk-MJHYApCa.js";import"./chunk-Cef-BAxw.js";const K=({data:t,onSelect:c,selectedId:o})=>{const[x,m]=s.useState({[t.id]:!0}),u=e=>{if(!e.children||0===e.children.length)return null;if("package"===e.type){const s=e.children.length;let t=0;return e.children.forEach((e=>{e.children&&(t+=e.children.length)})),t>0?`${s} suite${1!==s?"s":""}, ${t} case${1!==t?"s":""}`:`${s} suite${1!==s?"s":""}`}if("suite"===e.type){const s=e.children.length;return s>0?`${s} case${1!==s?"s":""}`:"No test cases"}return null},h=(s,t=0)=>{const g=s.children&&s.children.length>0,b=x[s.id],j=o===s.id,{icon:p,bgColor:N,textColor:f}=(s=>{switch(s){case"root":return{icon:e.jsx(a,{className:"text-gray-600"}),bgColor:"hover:bg-gray-50",textColor:"text-gray-700 font-medium"};case"package":return{icon:e.jsx(d,{className:"text-indigo-600"}),bgColor:"hover:bg-indigo-50",textColor:"text-indigo-700 font-medium"};case"suite":return{icon:e.jsx(l,{className:"text-blue-600"}),bgColor:"hover:bg-blue-50",textColor:"text-blue-700"};case"case":return{icon:e.jsx(i,{className:"text-green-600"}),bgColor:"hover:bg-green-50",textColor:"text-green-700"};default:return{icon:e.jsx(a,{className:"text-gray-500"}),bgColor:"hover:bg-gray-50",textColor:"text-gray-700"}}})(s.type,g);return u(s),e.jsxs("div",{className:""+(t>0?"ml-4":""),children:[e.jsx("div",{className:"flex items-center justify-between p-2.5 rounded-md cursor-pointer transition-all duration-200 group "+(j?"bg-indigo-100 text-indigo-700 shadow-sm border border-indigo-200":`${N} ${f}`),onClick:()=>c(s),children:e.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[g&&e.jsx("button",{className:"p-1 rounded-full hover:bg-white hover:shadow-sm transition-all duration-200 mr-2 "+(b?"rotate-0":"-rotate-90"),onClick:e=>{var t;e.stopPropagation(),t=s.id,m((e=>({...e,[t]:!e[t]})))},children:b?e.jsx(r,{className:"text-gray-400 group-hover:text-gray-600"}):e.jsx(n,{className:"text-gray-400 group-hover:text-gray-600"})}),e.jsx("span",{className:"mr-3 flex-shrink-0",children:p}),e.jsx("span",{className:"flex-1 font-medium text-sm truncate",children:s.name}),"case"!==s.type&&e.jsx("span",{className:"ml-2 text-xs px-2 py-1 rounded-full flex-shrink-0 "+(j?"bg-indigo-200 text-indigo-800":"bg-gray-200 text-gray-600 group-hover:bg-white group-hover:shadow-sm"),children:(()=>{const e=u(s);return null===e?"suite"===s.type?"Empty":"0":e})()})]})}),g&&e.jsx("div",{className:"overflow-hidden transition-all duration-300 "+(b?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"),children:e.jsxs("div",{className:(t<2?"ml-2 border-l border-gray-200 pl-2":"")+" mt-1",children:[s.children.map((e=>h(e,t+1))),"suite"===s.type&&0===s.children.length&&b&&e.jsx("div",{className:"ml-8 py-2 text-xs text-gray-400 italic",children:"No test cases in this suite"}),"package"===s.type&&0===s.children.length&&b&&e.jsx("div",{className:"ml-8 py-2 text-xs text-gray-400 italic",children:"No test suites in this package"})]})})]},s.id)};return t&&t.children&&0!==t.children.length?e.jsxs("div",{className:"border rounded-md p-4 h-full overflow-auto bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-gray-100",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:"Test Selection"}),t.children&&t.children.length>0&&e.jsxs("span",{className:"bg-indigo-100 text-indigo-700 text-xs py-1 px-3 rounded-full font-medium",children:[X(t)," items"]})]}),e.jsx("div",{className:"space-y-1",children:t.children&&t.children.length>0?t.children.map((e=>h(e,0))):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(a,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"No test packages found"})]})}),o&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-100",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Selected:"}),e.jsx("div",{className:"text-sm font-medium text-gray-700 truncate",children:Y(t,o)})]})]}):e.jsxs("div",{className:"border rounded-md p-4 h-full overflow-auto bg-white shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:"Test Selection"})}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-4 mb-4",children:e.jsx(a,{className:"h-8 w-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Tests Available"}),e.jsx("p",{className:"text-gray-500 max-w-sm",children:"No test packages, suites, or cases are available for execution. Create some test content to get started."})]})]})},X=e=>{let s=0;return e.children&&e.children.length>0&&e.children.forEach((e=>{s+=1,s+=X(e)})),s},Y=(e,s)=>{const t=(e,s,a=[])=>{if(e.id===s)return[...a,e.name].join(" > ");if(e.children)for(const r of e.children){const n=t(r,s,[...a,e.name]);if(n)return n}return null};return t(e,s)||"Unknown"},Z=({results:s,inProgress:t,onViewDetails:a,onViewAllResults:r})=>{if(!s&&!t)return e.jsxs("div",{className:"border rounded-md bg-white shadow-sm p-6 h-full flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:e.jsx(c,{className:"h-8 w-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Select and run a test to see results"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Results will appear here after execution"})]});const n=s||{instanceId:"In Progress",executedBy:"-",environment:"-",executedAt:"-",passedCount:0,failedCount:0,totalTests:0,results:[]},i=n.totalTests||n.results.length,l=n.passedCount+(n.executedCount||0),d=i>0?Math.round(l/i*100):0,p=n.results.length>0?Math.round(n.results.reduce(((e,s)=>e+parseFloat(s.duration?.replace("ms","")||"0")),0)/n.results.length):0,N=n.assertionSummary||(n.results&&n.results.length>0?{total:n.results.reduce(((e,s)=>e+(s.assertionSummary?.total||0)),0),passed:n.results.reduce(((e,s)=>e+(s.assertionSummary?.passed||0)),0),failed:n.results.reduce(((e,s)=>e+(s.assertionSummary?.failed||0)),0),skipped:n.results.reduce(((e,s)=>e+(s.assertionSummary?.skipped||0)),0)}:null);return e.jsxs("div",{className:"border rounded-md p-5 h-full overflow-auto bg-white shadow-sm",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:"Execution Details"}),e.jsx("div",{className:"px-3 py-1 rounded-md text-white text-sm font-medium shadow-sm "+(t?"bg-yellow-500":"PASSED"===n.executionStatus?"bg-green-500":"EXECUTED"===n.executionStatus?"bg-blue-500":"bg-red-500"),children:t?"In Progress":n.executionStatus||n.status})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-5",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(c,{className:"mr-1"})," Instance ID"]}),e.jsx("div",{className:"font-medium text-sm truncate",children:n.instanceId})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(o,{className:"mr-1"})," Executed By"]}),e.jsx("div",{className:"font-medium text-sm truncate",children:n.executedBy})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(x,{className:"mr-1"})," Environment"]}),e.jsx("div",{className:"font-medium text-sm truncate",children:n.environment})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(m,{className:"mr-1"})," Executed At"]}),e.jsx("div",{className:"font-medium text-sm truncate",children:n.executedAt})]})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"grid gap-4 "+((n.executedCount||0)>0?"grid-cols-2 md:grid-cols-5":"grid-cols-2 md:grid-cols-4"),children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Total Tests"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-700",children:i})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Passed"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.passedCount})]}),(n.executedCount||0)>0&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Executed"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.executedCount})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Failed"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:n.failedCount})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Success Rate"}),e.jsxs("div",{className:"text-2xl font-bold "+(d>=80?"text-green-600":d>=50?"text-yellow-600":"text-red-600"),children:[d,"%"]})]})]}),i>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[n.passedCount+n.failedCount+(n.executedCount||0)," / ",i]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsxs("div",{className:"flex h-2 rounded-full overflow-hidden",children:[e.jsx("div",{className:"bg-green-500 transition-all duration-500",style:{width:n.passedCount/i*100+"%"}}),e.jsx("div",{className:"bg-blue-500 transition-all duration-500",style:{width:(n.executedCount||0)/i*100+"%"}}),e.jsx("div",{className:"bg-red-500 transition-all duration-500",style:{width:n.failedCount/i*100+"%"}})]})})]})]}),!t&&N&&N.total>0&&e.jsx("div",{className:"mb-6",children:e.jsx(V,{summary:N,compact:!0,executionTime:p})}),!t&&n.results.length>0&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-blue-600 mb-1",children:[e.jsx(u,{className:"mr-1"})," Avg Duration"]}),e.jsxs("div",{className:"font-medium text-sm text-blue-700",children:[p,"ms"]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-purple-600 mb-1",children:[e.jsx(h,{className:"mr-1"})," Test Type"]}),e.jsx("div",{className:"font-medium text-sm text-purple-700",children:"package"===n.selectedItem?.type?"Package":"suite"===n.selectedItem?.type?"Suite":"case"===n.selectedItem?.type?"Test Case":"Mixed"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-md text-gray-700",children:"Test Cases"}),!t&&s?.results.length>0&&e.jsxs("button",{onClick:r,className:"text-xs px-3 py-1 bg-indigo-100 text-indigo-700 hover:bg-indigo-200 rounded-md transition-colors flex items-center",children:[e.jsx("span",{children:"View All Results"}),e.jsx(g,{className:"ml-1 h-3 w-3"})]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:t?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Running tests..."}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"This may take a few moments"})]}):s?.results.length>0?e.jsx("div",{className:"divide-y divide-gray-100 max-h-80 overflow-y-auto",children:s.results.slice(0,5).map((s=>{const t=W(s),r=G(t),n=z(s);return e.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 rounded-md border border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+("Passed"===t.displayText?"bg-green-500":"Executed"===t.displayText?"bg-blue-500":"bg-red-500")}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center space-x-2",children:[e.jsxs("span",{children:["Duration: ",s.duration]}),n&&e.jsxs("span",{className:"text-blue-600",children:["â€¢ ",n]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${r}`,children:t.displayText}),e.jsx("button",{onClick:()=>a(s.id),className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 rounded transition-colors",title:"View Details",children:"View Details"})]})]},s.id)}))}):s?.error?e.jsxs("div",{className:"p-6 text-center text-red-600",children:[e.jsx(b,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Execution Error"}),e.jsx("div",{className:"text-sm mt-1",children:s.error})]}):e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx(j,{className:"h-8 w-8 mx-auto mb-2"}),"No test results available"]})})]})]})},Q=({children:t,title:a,defaultOpen:r=!1})=>{const[n,i]=s.useState(r);return e.jsxs("div",{className:"border rounded",children:[e.jsxs("button",{className:"w-full flex items-center justify-between p-3 text-left text-sm font-medium bg-gray-50 focus:outline-none",onClick:()=>i(!n),children:[e.jsx("span",{children:a}),n?e.jsx(v,{className:"h-4 w-4 text-gray-500"}):e.jsx(N,{className:"h-4 w-4 text-gray-500"})]}),n&&e.jsx("div",{className:"p-3 border-t",children:t})]})},ee=({executionId:t,testCases:a,currentTestCaseId:r,onNavigate:n,onBack:i})=>{const[l,d]=s.useState(null);s.useEffect((()=>{if(!a||0===a.length)return;const e=a.findIndex((e=>e.id===r));-1!==e&&d(a[e])}),[a,r]);const c=e=>{if(!a||0===a.length)return;const s=a.findIndex((e=>e.id===r));if(-1===s)return;let i;i="next"===e?(s+1)%a.length:(s-1+a.length)%a.length,n(t,a[i].id)},o=e=>JSON.stringify(e,null,2);if(!l)return e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"text-gray-500 p-10",children:"Test case not found"}),e.jsx("button",{onClick:i,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Go Back"})]});const x=(()=>{if(!l?.assertions||0===l.assertions.length){return W(l).isExecutedWithoutAssertions?100:0}const e=l.assertions.filter((e=>"Passed"===e.status)).length;return Math.round(e/l.assertions.length*100)})();return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:i,className:"flex items-center text-indigo-600 hover:text-indigo-800 transition-colors",children:[e.jsx(p,{className:"mr-2"}),"Back to Execution"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c("prev"),className:"p-2 rounded-md border border-gray-200 hover:bg-gray-50 text-gray-600",title:"Previous test case",children:e.jsx(p,{size:14})}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Test ",a.findIndex((e=>e.id===r))+1," of ",a.length]}),e.jsx("button",{onClick:()=>c("next"),className:"p-2 rounded-md border border-gray-200 hover:bg-gray-50 text-gray-600",title:"Next test case",children:e.jsx(N,{size:14})})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-1 text-gray-800",children:l.name}),e.jsxs("p",{className:"text-gray-600",children:["Execution ID: ",t]})]}),e.jsxs("div",{children:[(()=>{const s=W(l),t=G(s);return e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${t}`,children:s.displayText})})(),W(l).isExecutedWithoutAssertions?e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"No assertions created"}):null]})]}),e.jsx("div",{className:"mb-6 bg-gray-100 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:`h-full ${(()=>{const e=W(l);return"Passed"===e.displayText?"bg-green-500":"Executed"===e.displayText?"bg-blue-500":"bg-red-500"})()} transition-all duration-500 ease-in-out`,style:{width:`${x}%`}})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"border rounded-lg shadow-sm p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:"Request"}),e.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-xs px-2 py-1 rounded-full",children:l.request?.method||"GET"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"URL"}),e.jsx("div",{className:"bg-gray-50 p-2 rounded border border-gray-100 font-mono text-sm break-all",children:l.request?.url||"No URL provided"})]}),l.request?.headers&&e.jsx("div",{className:"mb-3",children:e.jsx(Q,{title:"Headers",defaultOpen:!1,children:e.jsx("pre",{className:"bg-gray-50 p-3 rounded font-mono text-sm overflow-auto border border-gray-100 max-h-60",children:o(l.request.headers)})})}),l.request?.body&&e.jsx("div",{children:e.jsx(Q,{title:"Request Body",defaultOpen:!1,children:e.jsx("pre",{className:"bg-gray-50 p-3 rounded font-mono text-sm overflow-auto border border-gray-100 max-h-60",children:o(l.request.body)})})})]}),e.jsxs("div",{className:"border rounded-lg shadow-sm p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:"Response"}),e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+(l.response?.status>=200&&l.response?.status<300?"bg-green-100 text-green-800":l.response?.status>=400?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:["Status: ",l.response?.status||"Unknown"]})]}),l.response?.data&&e.jsx("div",{children:e.jsx(Q,{title:"Response Body",defaultOpen:!0,children:e.jsx("pre",{className:"bg-gray-50 p-3 rounded font-mono text-sm overflow-auto border border-gray-100 max-h-60",children:o(l.response.data)})})}),l.response?.headers&&e.jsx("div",{className:"mt-3",children:e.jsx(Q,{title:"Response Headers",defaultOpen:!1,children:e.jsx("pre",{className:"bg-gray-50 p-3 rounded font-mono text-sm overflow-auto border border-gray-100 max-h-60",children:o(l.response.headers)})})})]})]}),e.jsxs("div",{className:"border rounded-lg shadow-sm overflow-hidden bg-white",children:[e.jsx("div",{className:"bg-gray-50 p-4 border-b",children:e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:"Assertions"})}),e.jsxs("div",{className:"divide-y divide-gray-100",children:[l.assertions&&l.assertions.map((s=>e.jsx("div",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mt-0.5 rounded-full p-1 mr-3 "+("Passed"===s.status?"bg-green-100 text-green-600":"bg-red-100 text-red-600"),children:"Passed"===s.status?e.jsx(f,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["Assertion #",s.id]}),e.jsx("div",{className:"text-gray-600 mt-1",children:s.description}),"Passed"!==s.status&&s.error&&e.jsx("div",{className:"mt-2 bg-red-50 text-red-700 p-2 rounded text-sm border border-red-100",children:s.error})]})]}),e.jsx("div",{children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("Passed"===s.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:s.status})})]})},s.id))),(!l.assertions||0===l.assertions.length)&&e.jsx("div",{className:"p-4 text-center text-gray-500",children:e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 border border-blue-200",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"Test Executed Successfully"}),e.jsx("p",{className:"text-blue-700 mb-4",children:"This test case executed but had no assertions to validate the response."}),e.jsx("div",{className:"text-sm text-blue-800",children:"Consider adding assertions to validate response data, status codes, or performance metrics."})]})})]})]}),l.snippets&&e.jsxs("div",{className:"mt-6 border rounded-lg shadow-sm overflow-hidden bg-white",children:[e.jsxs("div",{className:"bg-gray-50 p-4 border-b flex items-center",children:[e.jsx(y,{className:"text-gray-500 mr-2"}),e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:"Code Snippets"})]}),e.jsx("div",{className:"p-4",children:e.jsx(Q,{title:"Test Code",defaultOpen:!1,children:e.jsx("pre",{className:"bg-gray-50 p-3 rounded font-mono text-sm overflow-auto border border-gray-100",children:l.snippets.testCode||"// No test code available"})})})]})]})},se=({isOpen:t,onClose:a,errorCode:r,errorMessage:n,testSuiteName:i,currentStrategy:l="Parallel",onRetryWithSequential:d,onEditConfiguration:c,onViewDetails:o})=>{const[x,m]=s.useState(!1),u="ERR-423"===r?{title:"Execution Strategy Conflict",icon:e.jsx(T,{className:"w-6 h-6 text-amber-600"}),iconBg:"bg-amber-100",explanation:"This test suite contains dynamic variable configurations that require sequential execution to maintain data dependencies between test cases.",recommendation:"Switch to Sequential execution to run this test suite properly.",technicalDetails:"Test cases with dynamic variables need to run in order to pass data between tests."}:{title:"Execution Configuration Error",icon:e.jsx(T,{className:"w-6 h-6 text-red-600"}),iconBg:"bg-red-100",explanation:"There was a configuration conflict with the selected execution strategy.",recommendation:"Please review your execution settings and try again.",technicalDetails:n};return e.jsx(_,{isOpen:t,onClose:a,size:"lg",showCloseButton:!1,children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-10 text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-md hover:bg-gray-100","aria-label":"Close",children:e.jsx(w,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:`mx-auto flex items-center justify-center w-16 h-16 rounded-full ${u.iconBg} mb-4`,children:u.icon}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:u.title}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 inline-flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Test Suite:"}),e.jsx("span",{className:"ml-2 font-medium text-gray-900",children:i}),e.jsx("span",{className:"mx-2 text-gray-300",children:"â€¢"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Current Strategy:"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-medium",children:l})]})]}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx("span",{className:"mr-1",children:"Error Code:"}),e.jsx("code",{className:"font-mono",children:r})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(S,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"What happened?"}),e.jsx("p",{className:"text-blue-800 text-sm leading-relaxed",children:u.explanation}),u.technicalDetails&&e.jsx("div",{className:"mt-3 p-3 bg-blue-100 rounded border border-blue-200",children:e.jsx("p",{className:"text-xs text-blue-700 font-mono",children:u.technicalDetails})})]})]})}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(C,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:"Recommended Solution"}),e.jsx("p",{className:"text-green-800 text-sm leading-relaxed",children:u.recommendation}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"bg-white border border-green-200 rounded p-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-green-600 text-lg mb-1",children:"ðŸ“‹"}),e.jsx("div",{className:"font-medium text-green-900 text-sm",children:"Sequential"}),e.jsx("div",{className:"text-xs text-green-700 mt-1",children:"Recommended"})]})}),e.jsx("div",{className:"bg-gray-100 border border-gray-300 rounded p-3 opacity-60",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-1",children:"âš¡"}),e.jsx("div",{className:"font-medium text-gray-700 text-sm",children:"Parallel"}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Not supported"})]})})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[e.jsx(J,{onClick:async()=>{m(!0);try{await d(),a()}catch(e){}finally{m(!1)}},variant:"primary",loading:x,className:"flex-1 flex items-center justify-center",icon:k,children:x?"Switching to Sequential...":"Run with Sequential Strategy"}),e.jsxs("div",{className:"flex gap-3 flex-1",children:[e.jsx(J,{onClick:c,variant:"secondary",className:"flex-1 flex items-center justify-center",icon:E,children:"Edit Configuration"}),o&&e.jsx(J,{onClick:o,variant:"ghost",className:"flex-1",children:"View Details"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Need help? Check the"," ",e.jsx("a",{href:"#",className:"text-indigo-600 hover:text-indigo-700 underline",children:"documentation"})," ","or contact support."]})})]})})},te=({isVisible:t,onDismiss:a,errorCode:r,errorMessage:n,testSuiteName:i,currentStrategy:l,onRetryWithSequential:d,onEditConfiguration:c,className:o=""})=>{const[x,m]=s.useState(!1),[u,h]=s.useState(!1);if(!t)return null;return e.jsx("div",{className:`relative mb-6 ${o}`,children:e.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200 rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:e.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:e.jsx(R,{className:"w-4 h-4 text-amber-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-amber-900",children:"Execution Strategy Conflict"}),e.jsx("button",{onClick:()=>m(!x),className:"ml-2 text-amber-600 hover:text-amber-700 transition-colors",children:x?e.jsx(I,{className:"w-4 h-4"}):e.jsx(q,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-sm text-amber-800 mb-3",children:[e.jsx("strong",{children:i})," requires Sequential execution due to dynamic variable dependencies."]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(J,{size:"sm",variant:"warning",onClick:async()=>{h(!0);try{await d(),a()}catch(e){}finally{h(!1)}},loading:u,icon:D,className:"bg-amber-600 hover:bg-amber-700 text-white",children:"Run Sequential"}),e.jsx(J,{size:"sm",variant:"ghost",onClick:c,className:"text-amber-700 hover:bg-amber-100",children:"Edit Settings"})]})]})]}),e.jsx("button",{onClick:a,className:"flex-shrink-0 ml-4 text-amber-400 hover:text-amber-600 transition-colors",children:e.jsx(b,{className:"w-4 h-4"})})]})}),x&&e.jsx("div",{className:"border-t border-amber-200 bg-amber-25 px-4 py-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(S,{className:"w-4 h-4 text-amber-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-amber-800 font-medium mb-1",children:"Technical Details:"}),e.jsxs("p",{className:"text-amber-700 text-xs font-mono bg-amber-100 p-2 rounded border",children:[r,": ",n]})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(S,{className:"w-4 h-4 text-amber-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-amber-800 font-medium mb-2",children:"Execution Strategies:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-green-100 border border-green-200 rounded p-2 text-center",children:[e.jsx("div",{className:"font-medium text-green-800",children:"ðŸ“‹ Sequential"}),e.jsx("div",{className:"text-green-600",children:"Maintains data flow"})]}),e.jsxs("div",{className:"bg-gray-100 border border-gray-200 rounded p-2 text-center opacity-60",children:[e.jsx("div",{className:"font-medium text-gray-700",children:"âš¡ Parallel"}),e.jsx("div",{className:"text-gray-600",children:"Not supported"})]})]})]})]})]})})]})})},ae=({execution:s,errorCode:t,errorMessage:a})=>{return e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-amber-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 px-6 py-4 border-b border-amber-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center",children:e.jsx(T,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-amber-900",children:"Configuration Error"}),e.jsxs("p",{className:"text-sm text-amber-700",children:[s?.selectedItem?.name||"Test Suite"," requires different execution settings","ERR-422"===t?" (Test Suite)":" (Test Case)"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-700 rounded text-xs font-medium",children:t})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-red-900 mb-2",children:"Execution Failed"}),e.jsx("p",{className:"text-red-800 text-sm mb-3",children:(r=s?.selectedItem,n=t,r?"ERR-422"===n?r.name?.toLowerCase().includes("api")?"API test suites require Sequential execution for proper request chaining and data flow.":r.name?.toLowerCase().includes("data")?"Data-driven test suites need Sequential execution to maintain variable dependencies between test cases.":r.name?.toLowerCase().includes("workflow")?"Workflow test suites require Sequential execution to maintain state and data flow between test cases.":"This test suite contains dependency variables that prevent parallel execution.":r.name?.toLowerCase().includes("api")?"This API test case requires Sequential execution for proper request chaining.":r.name?.toLowerCase().includes("data")?"This data-driven test case needs Sequential execution for variable dependencies.":r.name?.toLowerCase().includes("workflow")?"This workflow test case requires Sequential execution to maintain state.":"This test case requires Sequential execution due to dynamic variables.":"ERR-422"===n?"This test suite cannot be executed in parallel due to dependency variables.":"This test case requires Sequential execution due to dynamic variables.")}),e.jsx("div",{className:"bg-red-100 border border-red-200 rounded p-3",children:e.jsxs("p",{className:"text-xs text-red-700 font-mono",children:[t,": ",a]})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-gray-500"}),"Current Settings"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Strategy:"}),e.jsx("span",{className:"font-medium text-red-600",children:"Parallel"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Environment:"}),e.jsx("span",{className:"font-medium text-gray-900",children:s?.environment||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Executed By:"}),e.jsx("span",{className:"font-medium text-gray-900",children:s?.executedBy||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Executed At:"}),e.jsx("span",{className:"font-medium text-gray-900",children:s?.executedAt||"Unknown"})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-green-900 mb-3 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-green-500"}),"Recommended Solution"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-green-600 text-sm",children:"ðŸ“‹"})}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Switch to Sequential Execution"})]}),e.jsx("p",{className:"text-xs text-green-700",children:"ERR-422"===t?"Sequential execution maintains data dependencies between test cases and ensures proper variable flow across the entire test suite.":"Sequential execution maintains data dependencies and ensures proper variable flow for this test case."})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-3 flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-blue-500"}),"ERR-422"===t?"Test Suite Execution Strategy Comparison":"Test Case Execution Strategy Comparison"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("div",{className:"text-2xl mb-2",children:"ðŸ“‹"}),e.jsx("h5",{className:"font-semibold text-green-900",children:"Sequential"}),e.jsx("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full",children:"Recommended"})]}),e.jsxs("ul",{className:"text-xs text-green-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Tests run one after another"}),e.jsx("li",{children:"â€¢ Maintains data dependencies"}),e.jsx("li",{children:"â€¢ Supports dynamic variables"}),e.jsxs("li",{children:["â€¢"," ","ERR-422"===t?"Ensures test suite integrity":"Ensures test case reliability"]})]})]}),e.jsxs("div",{className:"bg-white border border-red-200 rounded-lg p-4 opacity-60",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("div",{className:"text-2xl mb-2",children:"âš¡"}),e.jsx("h5",{className:"font-semibold text-red-900",children:"Parallel"}),e.jsx("span",{className:"text-xs text-red-600 bg-red-100 px-2 py-1 rounded-full",children:"Not Supported"})]}),e.jsxs("ul",{className:"text-xs text-red-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Tests run simultaneously"}),e.jsx("li",{children:"â€¢ Breaks data dependencies"}),e.jsx("li",{children:"â€¢ No dynamic variable support"}),e.jsxs("li",{children:["â€¢"," ","ERR-422"===t?"Causes test suite failures":"Causes test case failures"]})]})]})]})]}),e.jsx("div",{className:"text-center pt-4 border-t border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Users can retry execution with Sequential strategy from the settings above."})})]})]});var r,n},re=()=>{const a=t(),[r,n]=s.useState(null),[i,l]=s.useState(!1),[d,c]=s.useState(null),[o,x]=s.useState(!1),[m,u]=s.useState({environment:"Staging",executionStrategy:"Sequential"}),[h,g]=s.useState("execution"),[b,j]=s.useState(null),[p,N]=s.useState(null),[f,y]=s.useState(!0),[w,S]=s.useState(null),[k,E]=s.useState([]),[T,I]=s.useState(!1),{user:q}=A(),{activeProject:P}=B(),[$,V]=s.useState(!1),[W,G]=s.useState(!1),[z,_]=s.useState(null),[J,X]=s.useState(null),[Y,Q]=s.useState(null),[re,ne]=s.useState(null),ie=async()=>{y(!0),S(null);try{const e=await O("/api/v1/packages/hierarchy","GET");let s;if(Array.isArray(e))s=e;else if(e&&e.result&&e.result.data)s=e.result.data;else{if(!e||!Array.isArray(e.data))return void S("Invalid response format from server");s=e.data}if(!Array.isArray(s))return void S("Invalid data format - expected array of packages");const t={id:"root",type:"root",name:"All Test Packages",children:s.map((e=>({id:`package-${e.id}`,type:"package",name:e.packageName,packageId:e.id,children:(e.testSuites||[]).map((e=>({id:`suite-${e.id}`,type:"suite",name:e.suiteName,suiteId:e.id,children:(e.testCases||[]).map((e=>({id:`case-${e.id}`,type:"case",name:e.caseName,caseId:e.id,children:[]})))})))})))};N(t)}catch(e){S(e.message||"Failed to load test hierarchy")}finally{y(!1)}},le=e=>{if(!e)return(new Date).toLocaleString();try{return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(s){return(new Date).toLocaleString()}};s.useEffect((()=>{ie(),(async()=>{if(P?.id){I(!0);try{const e=await F.getByProject(P.id);if(e&&e.result&&e.result.data){const s=(e.result.data.content||e.result.data).map((e=>({id:e.environmentId,name:e.environmentName,value:e.environmentName})));E(s),s.length>0&&(!m.environment||"Staging"===m.environment)&&u((e=>({...e,environment:s[0].value})))}}catch(e){U.error("Failed to load environments for the current project")}finally{I(!1)}}})()}),[P?.id]);const de=()=>{const e=[{label:"Test Execution"}];return"execution"===h?e.push({label:"Execute Tests"}):"testcase"===h&&d&&e.push({label:"Execute Tests",path:"/test-execution"},{label:`Execution ${d.id}`},{label:"Test Case Details"}),e},ce=async()=>{if(r){l(!0),c(null);try{const e=q?.username||localStorage.getItem("userId")||"current.user",s=(e=>{switch(e.type){case"package":return{method:L.executePackage,id:e.packageId,name:"Package"};case"suite":return{method:L.executeSuite,id:e.suiteId,name:"Suite"};case"case":return{method:L.executeTestCase,id:e.caseId,name:"Test Case"};default:throw new Error("Invalid selection type for execution")}})(r),t={executionStrategy:m.executionStrategy,environment:m.environment},a=await s.method(s.id,e,t);if(a.result&&a.result.code){const s=a.result.code,t=a.result.message;if("ERR-422"===s||"ERR-423"===s){const a={id:`exec-${Date.now()}-config-error`,status:"Configuration Error",errorType:"CONFIGURATION_ERROR",errorCode:s,errorMessage:t,instanceId:`exec-${Date.now()}-config-error`,executedBy:e,environment:m.environment,executedAt:(new Date).toLocaleString(),selectedItem:r,originalStrategy:m.executionStrategy,totalTests:0,passedCount:0,failedCount:0,results:[]};c(a),Q("CONFIGURATION_ERROR"),ne({item:r,settings:{...m}}),l(!1);const n="ERR-422"===s?"test suite":"test case";return void U.warning(`${r.name} requires Sequential execution for ${n} due to dynamic variables`)}throw new Error(`${s}: ${t}`)}const n=(e=>{const s=(e.testCaseResult||[]).map((s=>{const t=s.assertionResults||[],a=s.assertionSummary||{total:0,passed:0,failed:0,skipped:0},r=a.total>0?Math.round(a.passed/a.total*100):0;let n;if(0===a.total){const e=s.statusCode;n=e>=200&&e<400?"Executed":"Failed"}else n=0===a.failed&&a.passed>0?"Passed":"Failed";return{id:`tc-${s.testCaseId}`,name:s.testCaseName||`Test Case ${s.testCaseId}`,status:n,duration:`${s.executionTimeMs}ms`,request:{method:s.httpMethod,url:s.url,headers:s.requestHeaders||{},body:s.requestBody},response:{status:s.statusCode,data:s.responseBody,headers:s.responseHeaders||{}},assertionResults:t.map((e=>({id:e.assertionId,name:e.assertionName||"Assertion",type:"custom",status:"PASSED"===e.status?"Passed":"Failed",actualValue:e.actualValue,expectedValue:e.expectedValue,executionTime:e.executionTime||0,..."PASSED"!==e.status&&e.errorMessage&&{error:e.errorMessage}}))),assertionSummary:{...a,successRate:r},assertions:t.map(((e,s)=>({id:e.assertionId||s+1,description:e.assertionName||"Assertion",status:"PASSED"===e.status?"Passed":"Failed",error:e.errorMessage||null}))),executionId:s.resultId,testCaseId:s.testCaseId,executedBy:e.executedBy,executionDate:le(e.executionDate),testSuiteId:s.testSuiteId,testSuiteName:s.testSuiteName,environment:s.environmentName||e.environmentName}})),t=s.reduce(((e,s)=>e+s.assertionSummary.total),0),a=s.reduce(((e,s)=>e+s.assertionSummary.passed),0),r=s.reduce(((e,s)=>e+s.assertionSummary.failed),0);return{results:s,passedCount:s.filter((e=>"Passed"===e.status)).length,failedCount:s.filter((e=>"Failed"===e.status)).length,executedCount:s.filter((e=>"Executed"===e.status)).length,errorCount:0,totalTests:s.length,executionTime:e.executionTimeMs,successRate:s.length>0?Math.round(s.filter((e=>"Passed"===e.status||"Executed"===e.status)).length/s.length*100):0,environmentName:e.environmentName,executionStatus:e.executionStatus,assertionSummary:{total:t,passed:a,failed:r,skipped:0,successRate:t>0?Math.round(a/t*100):0}}})(a),i=`exec-${a.executionId}`,d={id:i,status:"PASSED"===n.executionStatus?"Passed":"Failed",executionStatus:n.executionStatus,instanceId:i,executedBy:e,environment:n.environmentName||m.environment,executedAt:le(a.executionDate),passedCount:n.passedCount,failedCount:n.failedCount,executedCount:n.executedCount,errorCount:n.errorCount,totalTests:n.totalTests,executionTime:n.executionTime,successRate:n.successRate,results:n.results,rawExecution:a,selectedItem:r,actualExecutionId:a.executionId};c(d),window.mockExecutionData=window.mockExecutionData||{},window.mockExecutionData[i]=d,U.success(`${s.name} execution completed (${m.executionStrategy}, ${m.environment}): ${n.passedCount} passed, ${n.failedCount} failed`)}catch(e){if("ERR-422"===e.code||"ERR-423"===e.code){const s={id:`exec-${Date.now()}-config-error`,status:"Configuration Error",errorType:"CONFIGURATION_ERROR",errorCode:e.code,errorMessage:e.message,instanceId:`exec-${Date.now()}-config-error`,executedBy:q?.username||localStorage.getItem("userId")||"current.user",environment:m.environment,executedAt:(new Date).toLocaleString(),selectedItem:r,originalStrategy:m.executionStrategy,totalTests:0,passedCount:0,failedCount:0,results:[]};c(s),Q("CONFIGURATION_ERROR"),ne({item:r,settings:{...m}});const t="ERR-422"===e.code?"test suite":"test case";U.warning(`${r?.name||"Selection"} requires Sequential execution for ${t} due to dynamic variables`)}else{U.error(`Execution failed: ${e.message}`);const s=`exec-${Date.now()}-error`,t={id:s,status:"Failed",executionStatus:"FAILED",instanceId:s,executedBy:q?.username||localStorage.getItem("userId")||"current.user",environment:m.environment,executedAt:(new Date).toLocaleString(),passedCount:0,failedCount:1,totalTests:1,results:[{id:"error-case",name:"Execution Error",status:"Failed",duration:"0ms",request:{method:"UNKNOWN",url:r?.name||"Unknown",headers:{},body:{}},response:{status:e.status||0,data:{error:e.message,code:e.code},headers:{}},assertions:[{id:1,description:"Execution attempt",status:"Failed",error:e.message}]}],error:e.message};c(t)}}finally{l(!1)}}},oe=(e,s)=>{j(s),window.history.pushState(null,"",`/test-execution/results/${e}/${s}`)},xe=()=>{g("execution"),j(null),window.history.pushState(null,"","/test-execution")},me=(e,s)=>{u({...m,[e]:s})},ue=async()=>{if(!re)return;je(d?.errorCode,re.item);const e=m.executionStrategy;u((e=>({...e,executionStrategy:"Sequential"})));try{c(null),Q(null),ne(null),n(re.item),await ce(),U.success(`${re.item.name} is now running with Sequential execution strategy`)}catch(s){throw u((s=>({...s,executionStrategy:e}))),s}},he=()=>{je(d?.errorCode,re?.item),c(null),Q(null),ne(null),U.info("Please update the execution strategy below")},ge=()=>{d?.errorCode&&re?.item&&je(d.errorCode,re.item),V(!1),G(!1),c(null),Q(null),ne(null)},be=async e=>{if("SUITE"===e.type&&"Parallel"===m.executionStrategy)try{(e.name?.toLowerCase().includes("dynamic")||e.name?.toLowerCase().includes("variable")||e.name?.toLowerCase().includes("dependent"))&&U.warning(`"${e.name}" may require Sequential execution due to dynamic variables`,{action:{label:"Switch to Sequential",onClick:()=>u((e=>({...e,executionStrategy:"Sequential"})))}})}catch(s){}},je=(e,s,t)=>{m.executionStrategy,(new Date).toISOString()};return"testcase"===h&&d?e.jsxs("div",{className:"p-6 font-inter text-gray-800",children:[e.jsx(H,{items:de()}),e.jsx(ee,{executionId:d.id,testCases:d.results,currentTestCaseId:b,onNavigate:oe,onBack:xe})]}):e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx(H,{items:de()}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-1",children:"Test Execution"}),e.jsx("p",{className:"text-gray-600",children:"Run test packages, suites, or individual cases"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>x(!o),className:"flex items-center gap-1 px-3 py-2 bg-white text-gray-700 rounded-md border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx(C,{className:"text-gray-500"}),e.jsx("span",{children:"Settings"}),e.jsx(v,{className:"ml-1 text-gray-400 transition-transform "+(o?"rotate-180":"")})]}),o&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-gray-100 z-50 animate-fade-in",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-t-xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-indigo-100 rounded-lg",children:e.jsx(C,{className:"text-indigo-600 text-sm"})}),e.jsx("h3",{className:"font-semibold text-gray-800",children:"Execution Settings"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Configure your test execution preferences"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full"}),"Environment"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:m.environment,onChange:e=>me("environment",e.target.value),disabled:T||0===k.length,className:"w-full bg-gray-50 border border-gray-200 rounded-lg px-3 py-2.5 text-sm text-gray-700 \n                                 focus:bg-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 \n                                 transition-all duration-200 appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:[T&&e.jsx("option",{value:"",children:"Loading environments..."}),!T&&0===k.length&&e.jsx("option",{value:"",children:"No environments found for this project"}),!T&&k.map((s=>e.jsxs("option",{value:s.value,children:["ðŸŒ ",s.name]},s.id)))]}),e.jsx(v,{className:"absolute right-3 top-3 text-gray-400 text-xs pointer-events-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full"}),"Execution Strategy"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>me("executionStrategy","Sequential"),className:"p-3 rounded-lg border-2 text-sm font-medium transition-all duration-200 \n                                  "+("Sequential"===m.executionStrategy?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-gray-200 bg-gray-50 text-gray-600 hover:border-gray-300 hover:bg-gray-100"),children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"text-lg",children:"ðŸ“‹"}),e.jsx("span",{children:"Sequential"})]})}),e.jsx("button",{onClick:()=>me("executionStrategy","Parallel"),className:"p-3 rounded-lg border-2 text-sm font-medium transition-all duration-200 \n                                  "+("Parallel"===m.executionStrategy?"border-indigo-500 bg-indigo-50 text-indigo-700":"border-gray-200 bg-gray-50 text-gray-600 hover:border-gray-300 hover:bg-gray-100"),children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"text-lg",children:"âš¡"}),e.jsx("span",{children:"Parallel"})]})})]}),e.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 p-2 rounded-lg",children:"Sequential"===m.executionStrategy?"ðŸ“‹ Tests will run one after another in order":"âš¡ Tests will run simultaneously for faster execution"})]})]}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-b-xl border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsx("span",{children:"Settings will apply to this execution"}),e.jsx("button",{onClick:()=>x(!1),className:"text-indigo-600 hover:text-indigo-700 font-medium",children:"Done"})]})})]})]}),e.jsx("button",{onClick:i?null:ce,disabled:!r||i,className:"flex items-center px-4 py-2 rounded-md text-white shadow-sm transition-colors "+(!r||i?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"),children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Running..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2"}),"Run"," ","package"===r?.type?"Package":"suite"===r?.type?"Suite":"case"===r?.type?"Test Case":"Selection"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-[calc(100vh-200px)]",children:f?e.jsxs("div",{className:"border rounded-md p-4 h-full bg-white shadow-sm flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Loading test hierarchy..."}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Please wait while we fetch your test structure"})]}):w?e.jsxs("div",{className:"border rounded-md p-6 h-full bg-white shadow-sm flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-4 mb-4",children:e.jsx(R,{className:"h-8 w-8 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Failed to Load Test Hierarchy"}),e.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:"Invalid response format from server"===w?"The server returned an unexpected response format. Please contact your administrator.":w}),e.jsxs("button",{onClick:()=>{ie()},className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Retry"]})]}):!p||p.children&&0===p.children.length?e.jsxs("div",{className:"border rounded-md p-6 h-full bg-white shadow-sm flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-4 mb-4",children:e.jsx("svg",{className:"h-8 w-8 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Test Packages Found"}),e.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:"You don't have any test packages created yet. Create test packages, suites, and cases to start running tests."}),e.jsx("button",{onClick:()=>a("/test-design/test-package"),className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Create Test Package"})]}):e.jsx(K,{data:p,onSelect:e=>{n(e),be(e)},selectedId:r?.id})}),e.jsx("div",{className:"h-[calc(100vh-200px)]",children:!d||"CONFIGURATION_ERROR"!==d.errorType&&"ERR-422"!==d.errorCode&&"ERR-423"!==d.errorCode?e.jsx(Z,{results:d,inProgress:i,onViewDetails:e=>{j(e),g("testcase"),d&&window.history.pushState(null,"",`/test-execution/results/${d.id}/${e}`)},onViewAllResults:()=>{d&&(window.mockExecutionData=window.mockExecutionData||{},window.mockExecutionData[d.id]=d,a("/test-results"))}}):e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(ae,{execution:d,errorCode:d.errorCode,errorMessage:d.errorMessage})})})]}),e.jsx(se,{isOpen:$,onClose:ge,errorCode:z?.code,errorMessage:z?.message,testSuiteName:J?.name||"Unknown Test Suite",currentStrategy:m.executionStrategy,onRetryWithSequential:ue,onEditConfiguration:he,onViewDetails:()=>{d?.errorCode&&U.info("Check console for detailed error information")}}),W&&e.jsx(te,{isVisible:W,onDismiss:ge,errorCode:z?.code,errorMessage:z?.message,testSuiteName:J?.name||"Unknown Test Suite",currentStrategy:m.executionStrategy,onRetryWithSequential:ue,onEditConfiguration:he})]})};export{re as default};
