import{j as e}from"./chunk-xjDKe2wf.js";import{u as s,r as t}from"./chunk-D8-U-K1F.js";import{i as a,c as r,h as n,j as i,k as c,l,m as d,n as o,o as m,p as x,g}from"../assets/index-OFcpw0jO.js";import{B as h}from"./chunk-Dw3wbBjo.js";import{y as u}from"./chunk-CALic51h.js";import{n as p}from"./chunk-BV3C3NLD.js";import{C as y}from"./chunk-CpSKtQtR.js";import"./chunk-SnPUoUoO.js";import"./chunk-SIvHljHK.js";const f=()=>{const f=s(),[j,b]=t.useState([]),[N,v]=t.useState([]),[k,w]=t.useState([]),[C,S]=t.useState(!1),[D,E]=t.useState(1),[P,M]=t.useState(!0),[I,T]=t.useState(!1),[z,F]=t.useState(""),L=Math.ceil(N.length/6),$=N.slice(6*(D-1),6*D),B=()=>{F(""),v(j)};t.useEffect((()=>{(async()=>{M(!0);try{const e=await g("/api/v1/packages?pageNo=0&limit=100&sortBy=createdDate&sortDir=DESC","GET"),{code:s,data:t,message:a}=e.result;if("200"===s){const e=t.content.map((e=>({id:e.testPackageID,packageId:e.testPackageID,name:e.packageName,count:e.testSuites?.length||0,created:e.createdDate,executed:e.updatedDate,status:e.status||"Pending"})));b(e),v(e)}else u.error(a||"Failed to fetch packages")}catch(e){u.error("Something went wrong while fetching packages")}finally{M(!1)}})()}),[]);const H=e=>{switch(e.toLowerCase()){case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"in progress":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"p-6 font-inter text-gray-800",children:[e.jsx(h,{items:[{label:"Test Design"},{label:"Test Package",path:"/test-design/test-package"}]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Test Packages"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your collection of test suites for execution"})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("input",{type:"text",placeholder:"Search packages...",value:z,onChange:e=>{const s=e.target.value.toLowerCase().trim();if(F(s),s){const e=j.filter((e=>e.name.toLowerCase().includes(s)||String(e.packageId).includes(s)));v(e)}else v(j);E(1)},className:"w-full px-10 py-2 border rounded-md border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),z&&e.jsx("button",{onClick:B,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx(r,{})})]})]}),e.jsx("div",{className:"flex justify-end mb-4",children:0===k.length?e.jsxs("button",{onClick:()=>f("/test-design/test-package/create"),className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 transition-colors flex items-center",children:[e.jsx(n,{className:"mr-2"}),"Create Test Package"]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("span",{className:"flex items-center px-3 py-1 bg-indigo-50 text-indigo-700 rounded-md",children:[k.length," item",1!==k.length?"s":""," selected"]}),e.jsxs("button",{onClick:()=>T(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center",children:[e.jsx(i,{className:"mr-2"}),"Delete"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>S(!C),className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 transition-colors flex items-center",children:[e.jsx(c,{className:"mr-2"}),"Export"]}),C&&e.jsxs("div",{className:"absolute right-0 mt-2 bg-white border rounded-md shadow-lg w-40 z-10 animate-fade-in",children:[e.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer rounded-t-md flex items-center text-gray-700",children:[e.jsxs("svg",{className:"w-5 h-5 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2-1a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V4a1 1 0 00-1-1H6z",clipRule:"evenodd"})]}),"PDF"]}),e.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer rounded-b-md flex items-center text-gray-700 border-t",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 5a2 2 0 012-2h10a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V5zm11 1H6v8l4-2 4 2V6z",clipRule:"evenodd"})}),"Excel"]})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:P?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading test packages..."})]}):0===N.length?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-4 mb-4",children:e.jsx(l,{className:"h-8 w-8 text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No test packages found"}),e.jsx("p",{className:"text-gray-500 mb-6 text-center max-w-md",children:z?`No packages match your search "${z}"`:"Create your first test package to organize test suites for execution"}),z?e.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors flex items-center",onClick:B,children:[e.jsx(r,{className:"mr-2"}),"Clear Search"]}):e.jsxs("button",{className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 transition-colors flex items-center",onClick:()=>f("/test-design/test-package/create"),children:[e.jsx(n,{className:"mr-2"}),"Create Test Package"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-sm text-left table-fixed",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 font-medium w-[5%]",children:e.jsx("input",{type:"checkbox",onChange:()=>{const e=$.map((e=>e.id)),s=e.every((e=>k.includes(e)));w(s?k.filter((s=>!e.includes(s))):[...new Set([...k,...e])])},checked:$.length>0&&$.every((e=>k.includes(e.id))),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("th",{className:"py-3 px-4 font-medium w-[10%]",children:"ID"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[25%]",children:"Package Name"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[10%] text-center",children:"Suites"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[15%]",children:"Created"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[20%]",children:"Last Executed"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[15%]",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:$.map((s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",checked:k.includes(s.id),onChange:()=>{return e=s.id,void w((s=>s.includes(e)?s.filter((s=>s!==e)):[...s,e]));var e},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 font-mono text-xs truncate",children:s.packageId}),e.jsx("td",{onClick:()=>f("/test-design/test-package/create",{state:{package:{id:s.id,...s}}}),className:"py-3 px-4 text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer truncate",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"truncate",children:s.name}),e.jsx(d,{className:"ml-1 flex-shrink-0 h-4 w-4"})]})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"bg-indigo-50 text-indigo-700 px-2 py-1 rounded-full text-xs font-medium",children:s.count})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 truncate",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(o,{className:"mr-1 flex-shrink-0 h-3 w-3 text-gray-400"}),e.jsx("span",{className:"truncate",children:s.created})]})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 truncate",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{className:"mr-1 flex-shrink-0 h-3 w-3 text-gray-400"}),e.jsx("span",{className:"truncate",children:s.executed||"Never"})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${H(s.status)}`,children:["Completed"===s.status&&e.jsx(x,{className:"mr-1 h-3 w-3"}),s.status]})})]},s.id)))})]}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",Math.min(6*(D-1)+1,N.length)," to"," ",Math.min(6*D,N.length)," of ",N.length," items"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>E((e=>Math.max(e-1,1))),disabled:1===D,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-40 text-gray-600 transition-colors",children:"Previous"}),(()=>{const e=[];e.push(1),D>4&&e.push("...");for(let s=Math.max(2,D-2);s<=Math.min(L-1,D+2);s++)e.push(s);return D+2<L-1&&e.push("..."),L>1&&e.push(L),e})().map(((s,t)=>e.jsx("button",{disabled:"..."===s,onClick:()=>"..."!==s&&E(s),className:`px-3 py-1 border rounded-md ${s===D?"bg-indigo-600 text-white border-indigo-600":"hover:bg-gray-100 text-gray-600"} transition-colors`,children:s},t))),e.jsx("button",{onClick:()=>E((e=>Math.min(e+1,L))),disabled:D===L||0===L,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-40 text-gray-600 transition-colors",children:"Next"})]})]})]})})]}),e.jsx(y,{isOpen:I,onClose:()=>T(!1),onConfirm:async()=>{if(0===k.length)return void u.error("Please select package(s) to delete");const e={requestMetaData:{userId:localStorage.getItem("userId")||"302",transactionId:p(),timestamp:(new Date).toISOString()},data:k};try{const s=await g("/api/v1/packages/delete","DELETE",e),{code:t,message:a}=s.result;"200"===t?(u.success(a||"Packages deleted successfully"),b((e=>e.filter((e=>!k.includes(e.id))))),v((e=>e.filter((e=>!k.includes(e.id))))),w([])):u.error(a||"Failed to delete packages")}catch(s){u.error("Error deleting packages")}finally{T(!1)}},title:"Delete Test Packages",message:`Are you sure you want to delete ${k.length} selected test package${1!==k.length?"s":""}? This action cannot be undone.`})]})};export{f as default};
