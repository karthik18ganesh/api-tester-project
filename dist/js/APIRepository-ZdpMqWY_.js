import{j as e}from"./chunk-D8bRv3Ag.js";import{u as t,r as s}from"./chunk-C74fWxxE.js";import{h as r,c as a,i as n,j as l,k as i,Q as o,m as d,f as c,R as m}from"../assets/index-DUtqALCq.js";import{B as x}from"./chunk-Daju2wTE.js";import{y as h}from"./chunk-Dw5YO7VD.js";import{C as u}from"./chunk-3k1Tcz0K.js";import"./chunk-SnPUoUoO.js";import"./chunk-4QNEI4IN.js";import"./chunk-DTxknuJ7.js";const g=()=>{const g=t(),[p,y]=s.useState([]),[b,f]=s.useState([]),[j,N]=s.useState(!0),[v,w]=s.useState([]),[C,k]=s.useState(!1),[P,I]=s.useState(1),[A,S]=s.useState(!1),[E,D]=s.useState(""),[z,L]=s.useState(null),[M,R]=s.useState({totalElements:0,totalPages:0,pageNumber:0,pageSize:6,sort:{direction:"DESC",property:"createdDate"}}),$=M.totalPages,F=b,T=async(e=0)=>{N(!0),L(null);try{const t=await m.getAll(e,6,"createdDate","DESC");if(!(t&&t.result&&t.result.data))throw new Error("Invalid response format");{const e=t.result.data.content.map((e=>({id:e.apiId,apiId:`API-${e.apiId}`,name:e.apiRepoName,method:e.method,url:e.url,description:e.description||"",createdDate:new Date(e.createdDate).toLocaleDateString("en-GB"),environment:e.envId})));y(e),f(e),R({totalElements:t.result.data.totalElements,totalPages:t.result.data.totalPages,pageNumber:t.result.data.pageable.pageNumber,pageSize:t.result.data.pageable.pageSize,sort:t.result.data.pageable.sort})}}catch(t){L("Failed to load APIs. Please try again later."),h.error("Error fetching APIs: "+(t.message||"Unknown error"))}finally{N(!1)}},B=()=>{D(""),f(p)},H=e=>{switch(e.toUpperCase()){case"GET":return"bg-green-100 text-green-800";case"POST":return"bg-blue-100 text-blue-800";case"PUT":return"bg-yellow-100 text-yellow-800";case"DELETE":return"bg-red-100 text-red-800";case"PATCH":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},U=e=>{switch(("string"==typeof e?e.toLowerCase():"").replace(/^env_/i,"")){case"production":return"bg-red-100 text-red-800";case"staging":return"bg-amber-100 text-amber-800";case"development":return"bg-green-100 text-green-800";case"testing":case"qa":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},V=e=>{if(!e)return"Unknown";const t=e.replace(/^env_/i,"");return t.charAt(0).toUpperCase()+t.slice(1)},G=e=>{T(e-1),I(e)};return s.useEffect((()=>{T()}),[]),e.jsxs("div",{className:"p-6 font-inter text-gray-800",children:[e.jsx(x,{items:[{label:"API Design"},{label:"API Repository"}]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"API Repository"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your collection of API endpoints for testing"})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("input",{type:"text",placeholder:"Search APIs...",value:E,onChange:e=>{const t=e.target.value.toLowerCase();if(D(t),t.trim()){const e=p.filter((e=>e.name.toLowerCase().includes(t)||e.apiId.toString().includes(t)||e.url.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)));f(e)}else f(p)},className:"w-full px-10 py-2 border rounded-md border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),e.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),E&&e.jsx("button",{onClick:B,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 hover:-translate-y-0.5 transition-all",children:e.jsx(a,{})})]})]}),e.jsx("div",{className:"flex justify-end mb-4",children:0===v.length?e.jsxs("button",{onClick:()=>g("/test-design/api-repository/create"),className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center",children:[e.jsx(n,{className:"mr-2"}),"Create API"]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("span",{className:"flex items-center px-3 py-1 bg-indigo-50 text-indigo-700 rounded-md",children:[v.length," item",1!==v.length?"s":""," selected"]}),e.jsxs("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 hover:-translate-y-0.5 transition-all flex items-center",children:[e.jsx(l,{className:"mr-2"}),"Delete"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>k(!C),className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center",children:[e.jsx(i,{className:"mr-2"}),"Export"]}),C&&e.jsxs("div",{className:"absolute right-0 mt-2 bg-white border rounded-md shadow-lg w-40 z-10 animate-fade-in",children:[e.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer rounded-t-md flex items-center text-gray-700",children:[e.jsxs("svg",{className:"w-5 h-5 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2-1a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V4a1 1 0 00-1-1H6z",clipRule:"evenodd"})]}),"PDF"]}),e.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer rounded-b-md flex items-center text-gray-700 border-t",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 5a2 2 0 012-2h10a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V5zm11 1H6v8l4-2 4 2V6z",clipRule:"evenodd"})}),"Excel"]})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:j?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading APIs..."})]}):z?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-4 mb-4 text-red-600",children:e.jsx("svg",{className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:z}),e.jsx("button",{className:"mt-4 px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all",onClick:()=>T(),children:"Try Again"})]}):0===b.length?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-4 mb-4",children:e.jsx(o,{className:"h-8 w-8 text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No APIs found"}),e.jsx("p",{className:"text-gray-500 mb-6 text-center max-w-md",children:E?`No APIs match your search "${E}"`:"Create your first API to start testing endpoints"}),E?e.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 hover:-translate-y-0.5 transition-all flex items-center",onClick:B,children:[e.jsx(a,{className:"mr-2"}),"Clear Search"]}):e.jsxs("button",{className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center",onClick:()=>g("/test-design/api-repository/create"),children:[e.jsx(n,{className:"mr-2"}),"Create API"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left table-fixed",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 font-medium w-[5%]",children:e.jsx("input",{type:"checkbox",onChange:()=>{const e=F.map((e=>e.id)),t=e.every((e=>v.includes(e)));w((s=>t?s.filter((t=>!e.includes(t))):[...new Set([...s,...e])]))},checked:F.length>0&&F.every((e=>v.includes(e.id))),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("th",{className:"py-3 px-4 font-medium w-[10%]",children:"API ID"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[20%]",children:"API Name"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[10%] text-center",children:"Method"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[20%]",children:"Endpoint"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[10%] text-center",children:"Environment"}),e.jsx("th",{className:"py-3 px-4 font-medium w-[25%]",children:"Description"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:F.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",checked:v.includes(t.id),onChange:()=>{return e=t.id,void w((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]));var e},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 font-mono text-xs truncate",children:t.apiId}),e.jsx("td",{onClick:()=>g("/test-design/api-repository/create",{state:{apiId:t.id}}),className:"py-3 px-4 text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer truncate",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"truncate",children:t.name}),e.jsx(d,{className:"ml-1 flex-shrink-0 h-4 w-4"})]})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${H(t.method)}`,children:t.method})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 truncate",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{className:"mr-1 flex-shrink-0 h-3 w-3 text-gray-400"}),e.jsx("span",{className:"truncate font-mono text-xs",children:t.url})]})}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${U(t.environment)}`,children:V(t.environment)})}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:e.jsx("div",{className:"truncate",children:t.description||"-"})})]},t.id)))})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",Math.min(M.pageNumber*M.pageSize+1,M.totalElements)," to"," ",Math.min((M.pageNumber+1)*M.pageSize,M.totalElements)," of ",M.totalElements," items"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>G(P-1),disabled:1===P,className:"px-3 py-1 border rounded-md hover:bg-gray-100 hover:-translate-y-0.5 disabled:opacity-40 disabled:hover:transform-none text-gray-600 transition-all",children:"Previous"}),(()=>{const e=[];e.push(1),M.pageNumber>3&&e.push("...");for(let t=Math.max(2,M.pageNumber);t<=Math.min($-1,M.pageNumber+2);t++)e.push(t);return M.pageNumber+2<$-1&&e.push("..."),$>1&&e.push($),e})().map(((t,s)=>e.jsx("button",{disabled:"..."===t,onClick:()=>"..."!==t&&G(t),className:"px-3 py-1 border rounded-md hover:-translate-y-0.5 transition-all "+(t===P?"bg-indigo-600 text-white border-indigo-600":"hover:bg-gray-100 text-gray-600"),children:t},s))),e.jsx("button",{onClick:()=>G(P+1),disabled:P===$||0===$,className:"px-3 py-1 border rounded-md hover:bg-gray-100 hover:-translate-y-0.5 disabled:opacity-40 disabled:hover:transform-none text-gray-600 transition-all",children:"Next"})]})]})]})})]}),e.jsx(u,{isOpen:A,onClose:()=>S(!1),onConfirm:async()=>{if(0!==v.length)try{h.success(`Successfully deleted ${v.length} API${v.length>1?"s":""}`),w([]),T(M.pageNumber)}catch(e){h.error("Error occurred while deleting APIs")}finally{S(!1)}else h.warning("No APIs selected for deletion")},title:"Delete APIs",message:`Are you sure you want to delete ${v.length} selected API${1!==v.length?"s":""}? This action cannot be undone.`})]})};export{g as default};
