import{j as e}from"./chunk-BAZEzdRI.js";import{R as t,r as s}from"./chunk-N8EMqdL-.js";import{b as a,c as r,an as l,ao as n,ag as i,ac as d,a8 as o,a7 as c,ap as u,a as x,al as m,aq as g,h,am as p}from"../assets/index-8TFbwAj4.js";import{y}from"./chunk-CQIvISRI.js";import b from"./ExecutionDetailsView-ajDemyrq.js";import j from"./TestCaseDetailsView-zL3Ve8ti.js";import{B as f}from"./chunk-DOqeVFSN.js";import"./chunk-MJHYApCa.js";import"./chunk-Cef-BAxw.js";import"./chunk-ixgbBNuN.js";import"./chunk-DvM4gKK_.js";const N=({results:s,onViewExecution:u,onFilter:x,totalResults:m,currentPage:g,pageSize:h})=>{const[p,y]=t.useState(""),[b,j]=t.useState("all"),[f,N]=t.useState(!1),[v,w]=t.useState(!1),S=s||[],C=m||0,k=t.useMemo((()=>S.filter((e=>{const t=e.id.toLowerCase().includes(p.toLowerCase())||e.executedBy.toLowerCase().includes(p.toLowerCase()),s="all"===b||e.status.toLowerCase()===b.toLowerCase();return t&&s}))),[S,p,b]),D=e=>{j(e),N(!1),x&&x(e)},T=e=>{w(!1)};return t.useEffect((()=>{const e=e=>{e.target.closest(".filter-dropdown")||N(!1),e.target.closest(".export-dropdown")||w(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)}),[]),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 p-4 border-b border-gray-200 flex flex-col md:flex-row gap-4 justify-between",children:[e.jsxs("h2",{className:"font-semibold text-lg text-gray-800 flex items-center",children:["Test Results",e.jsxs("span",{className:"ml-2 bg-indigo-100 text-indigo-700 text-xs py-1 px-2 rounded-full",children:[C," executions"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search executions...",value:p,onChange:e=>y(e.target.value),className:"pl-9 pr-4 py-2 border rounded-md text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-64"}),e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),p&&e.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx(r,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative inline-block filter-dropdown",children:[e.jsxs("button",{className:"flex items-center gap-1 px-3 py-2 border rounded-md text-sm text-gray-700 bg-white hover:bg-gray-50",onClick:()=>N(!f),children:[e.jsx(l,{className:"text-gray-500"}),e.jsx("span",{children:"all"===b?"All Status":"passed"===b?"Passed":"failed"===b?"Failed":"Filter"})]}),f&&e.jsx("div",{className:"absolute right-0 mt-2 w-36 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:e.jsxs("div",{className:"py-1",children:[e.jsx("button",{onClick:()=>D("all"),className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 "+("all"===b?"text-indigo-600 bg-indigo-50":"text-gray-700"),children:"All Status"}),e.jsx("button",{onClick:()=>D("passed"),className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 "+("passed"===b?"text-indigo-600 bg-indigo-50":"text-gray-700"),children:"Passed"}),e.jsx("button",{onClick:()=>D("failed"),className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 "+("failed"===b?"text-indigo-600 bg-indigo-50":"text-gray-700"),children:"Failed"})]})})]}),e.jsxs("div",{className:"relative inline-block export-dropdown",children:[e.jsxs("button",{className:"flex items-center gap-1 px-3 py-2 border rounded-md text-sm text-gray-700 bg-white hover:bg-gray-50",onClick:()=>w(!v),children:[e.jsx(n,{className:"text-gray-500"}),e.jsx("span",{children:"Export"})]}),v&&e.jsx("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:e.jsxs("div",{className:"py-1",children:[e.jsx("button",{onClick:()=>T(),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"PDF"}),e.jsx("button",{onClick:()=>T(),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Excel"}),e.jsx("button",{onClick:()=>T(),className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"CSV"})]})})]})]})]}),0===k.length?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-3 inline-flex mb-4",children:e.jsx(a,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No results found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:p||"all"!==b?"Try adjusting your search or filter criteria":"No test executions available"}),(p||"all"!==b)&&e.jsx("button",{onClick:()=>{y(""),j("all")},className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm",children:"Clear Filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Execution ID"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tests"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assertions"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Executed at"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Executed by"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map((t=>{const s=t.executionStatus||t.status,a="EXECUTED"===s,r="PASSED"===s,l="PASSED"===(n=s)?"bg-green-100 text-green-800 border border-green-200":"EXECUTED"===n?"bg-blue-100 text-blue-800 border border-blue-200":"bg-red-100 text-red-800 border border-red-200";var n;const x="PASSED"===s?"Passed":"EXECUTED"===s?"Executed":"Failed";return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsx("button",{className:"text-indigo-600 hover:text-indigo-800 font-medium hover:underline focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded",onClick:()=>u&&u(t.id),children:t.id})}),e.jsxs("td",{className:"py-4 px-4",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${l}`,children:[r||a?e.jsx(i,{className:"mr-1 h-3 w-3"}):e.jsx(d,{className:"mr-1 h-3 w-3"}),x]}),a&&e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"No assertions created"})]}),e.jsxs("td",{className:"py-4 px-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-green-600 font-medium mr-1",children:t.passedTests||0}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-red-600 font-medium ml-1",children:t.failedTests||0})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[t.totalTests||0," total"]})]}),e.jsx("td",{className:"py-4 px-4",children:t.assertionSummary&&t.assertionSummary.total>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(i,{className:"mr-1 h-3 w-3 text-green-600"}),e.jsx("span",{className:"text-green-600 font-medium mr-1",children:t.assertionSummary.passed}),e.jsx("span",{className:"text-gray-500",children:"/"}),e.jsx("span",{className:"text-red-600 font-medium ml-1",children:t.assertionSummary.failed})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[t.assertionSummary.total," total",t.assertionSummary.skipped>0&&e.jsxs("span",{className:"text-gray-400 ml-1",children:["(",t.assertionSummary.skipped," skipped)"]})]})]}):e.jsx("div",{className:"text-gray-400 text-sm",children:"No assertions"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(o,{className:"mr-1 h-3 w-3"}),e.jsx("span",{className:"text-sm",children:t.executedAt})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(c,{className:"mr-1 h-3 w-3"}),e.jsx("span",{className:"text-sm",children:t.executedBy})]})})]},t.id)}))})]})})]})},v=10,w=()=>{const[t,a]=s.useState(null),[r,l]=s.useState(!1),[n,i]=s.useState("all"),[c,w]=s.useState(!1),[S,C]=s.useState(!1),[k,D]=s.useState({startDate:"",endDate:""}),[T,E]=s.useState("results"),[R,I]=s.useState(null),[A,P]=s.useState({status:"all",executedBy:""}),[B,F]=s.useState([]),[M,$]=s.useState(1),[L,V]=s.useState({pageNumber:0,pageSize:v,totalElements:0,totalPages:0,first:!0,last:!1}),H=async(e=0)=>{l(!0);try{const t=await p.getExecutionHistory(e,v,"executionDate","DESC");if(!t||!t.result||"200"!==t.result.code)throw new Error(t?.result?.message||"Failed to fetch execution history");{const{data:s}=t.result,a=(s.content||[]).map((e=>{let t=0,s=0,a=0,r=0;e.testCaseResults&&e.testCaseResults.length>0&&e.testCaseResults.forEach((e=>{e.assertionSummary&&(t+=e.assertionSummary.total||0,s+=e.assertionSummary.passed||0,a+=e.assertionSummary.failed||0,r+=e.assertionSummary.skipped||0)}));const l=t>0?{total:t,passed:s,failed:a,skipped:r,successRate:Math.round(s/t*100)}:null,n=e.testCaseResults?e.testCaseResults.filter((e=>e.assertionSummary&&e.assertionSummary.total>0)):[],i=t>0?n.length:0,d=t>0?n.filter((e=>e.assertionSummary&&0===e.assertionSummary.failed&&e.assertionSummary.passed>0)).length:0,o=i-d;return{id:`exec-${e.executionId}`,executionId:e.executionId,status:e.executionStatus||"FAILED",executionStatus:e.executionStatus,passedFailed:`${d}/${i}`,executedAt:z(e.executionDate),executedBy:e.executedBy||"Unknown",date:e.executionDate?new Date(e.executionDate.replace(" ","T")).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],rawData:e,totalTests:i,passedTests:d,failedTests:o,errorTests:e.executionSummary?.errorTests||0,successRate:e.executionSummary?.successRate||0,executionTime:e.executionTimeMs||0,environmentName:e.environmentName||"Unknown",testCaseResults:e.testCaseResults||[],assertionSummary:l}}));F(a),V({pageNumber:s.pageable?.pageNumber||0,pageSize:s.pageable?.pageSize||v,totalElements:s.totalElements||0,totalPages:s.totalPages||0,first:s.first||!1,last:s.last||!1}),$(e+1)}}catch(t){y.error("Failed to load execution history"),F([]),V({pageNumber:0,pageSize:v,totalElements:0,totalPages:0,first:!0,last:!0})}finally{l(!1)}},z=e=>{if(!e)return"Unknown";try{return new Date(e.replace(" ","T")).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(t){return e}};s.useEffect((()=>{H(0)}),[]);const U=s.useMemo((()=>B.filter((e=>{const t=((e,t)=>{const s=new Date(e),a=new Date;a.setHours(23,59,59,999);const r=new Date(a);r.setDate(r.getDate()-1),r.setHours(0,0,0,0);const l=new Date(a);l.setDate(l.getDate()-7),l.setHours(0,0,0,0);const n=new Date(a);switch(n.setMonth(n.getMonth()-1),n.setHours(0,0,0,0),t){case"today":const e=new Date(a);return e.setHours(0,0,0,0),s>=e&&s<=a;case"yesterday":const t=new Date(r);return t.setHours(23,59,59,999),s>=r&&s<=t;case"week":return s>=l&&s<=a;case"month":return s>=n&&s<=a;case"custom":if(!k.startDate||!k.endDate)return!0;const i=new Date(k.startDate),d=new Date(k.endDate);return d.setHours(23,59,59,999),s>=i&&s<=d;default:return!0}})(e.date,n),s="all"===A.status||e.status.toLowerCase()===A.status.toLowerCase(),a=!A.executedBy||e.executedBy.toLowerCase().includes(A.executedBy.toLowerCase());return t&&s&&a}))),[B,n,A,k]),O=e=>({id:e.id,status:e.status,instanceId:e.id,executedBy:e.executedBy,environment:e.environmentName,executedAt:e.executedAt,passedCount:e.passedTests,failedCount:e.failedTests,errorCount:e.errorTests,totalTests:e.totalTests,executionTime:e.executionTime,successRate:e.successRate,results:[]}),q=e=>{I(e),E("testcase"),t&&window.history.pushState(null,"",`/test-execution/results/${t.id}/${e}`)},X=()=>{E("execution"),I(null),t&&window.history.pushState(null,"",`/test-execution/results/${t.id}`)},W=()=>{a(null),E("results"),I(null),window.history.pushState(null,"","/test-results")},Y=(e,t)=>{P({...A,[e]:t})},G=e=>{i(e),"custom"===e?C(!0):(C(!1),D({startDate:"",endDate:""}))},J=()=>{P({status:"all",executedBy:""}),i("all"),D({startDate:"",endDate:""}),C(!1)},K="all"!==A.status||""!==A.executedBy||"all"!==n,Q=e=>{const t=e-1;$(e),H(t)},Z=()=>{const e=[{label:"Test Execution"}];return"results"===T?e.push({label:"Test Results"}):"execution"===T?e.push({label:"Test Results",path:"/test-results"},{label:`Execution ${t?.id||""}`}):"testcase"===T&&e.push({label:"Test Results",path:"/test-results"},{label:`Execution ${t?.id||""}`,path:`/test-execution/results/${t?.id}`},{label:"Test Case Details"}),e};return"testcase"===T&&t&&R?e.jsxs("div",{className:"p-6 font-inter text-gray-800",children:[e.jsx(f,{items:Z()}),e.jsx(j,{executionId:t.id,testCaseId:R,onBack:X})]}):"execution"===T&&t?e.jsxs("div",{className:"p-6 font-inter text-gray-800",children:[e.jsx(f,{items:Z()}),e.jsx(b,{execution:t,onBack:W,onViewTestCase:q})]}):e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsx(f,{items:Z()}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-1",children:"Test Results"}),e.jsx("p",{className:"text-gray-600",children:"View history of all test executions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>w(!c),className:"flex items-center gap-1 px-3 py-2 bg-white text-gray-700 rounded-md border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx(u,{className:"text-gray-500"}),e.jsx("span",{children:"Filters"}),K&&e.jsx("span",{className:"ml-1 bg-red-100 text-red-800 text-xs px-1.5 py-0.5 rounded-full",children:Object.values(A).filter((e=>e&&"all"!==e)).length+("all"!==n?1:0)}),e.jsx(x,{className:"ml-1 text-gray-400 transition-transform "+(c?"rotate-180":"")})]}),c&&e.jsxs("div",{className:"absolute right-0 mt-1 w-72 bg-white rounded-md shadow-lg border border-gray-200 z-10 animate-fade-in",children:[e.jsx("div",{className:"p-3 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-gray-700",children:"Filter Options"}),K&&e.jsx("button",{onClick:J,className:"text-xs text-red-600 hover:text-red-800",children:"Clear All"})]})}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:A.status,onChange:e=>Y("status",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"passed",children:"Passed Only"}),e.jsx("option",{value:"failed",children:"Failed Only"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Executed By"}),e.jsx("input",{type:"text",value:A.executedBy,onChange:e=>Y("executedBy",e.target.value),placeholder:"Username",className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>w(!1),className:"px-3 py-1 bg-indigo-600 text-white text-sm rounded hover:bg-indigo-700",children:"Apply"})})]})]})]}),e.jsxs("button",{onClick:()=>{H(L.pageNumber)},className:"flex items-center gap-1 px-3 py-2 bg-white text-gray-700 rounded-md border border-gray-200 hover:bg-gray-50 transition-colors",disabled:r,children:[e.jsx(m,{className:"text-gray-500 "+(r?"animate-spin":"")}),e.jsx("span",{children:"Refresh"})]}),e.jsx("div",{className:"relative",children:e.jsxs("button",{className:"flex items-center gap-1 px-3 py-2 bg-white text-gray-700 rounded-md border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx(g,{className:"text-gray-500"}),e.jsx("span",{children:"Export"}),e.jsx(x,{className:"ml-1 text-gray-400"})]})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 flex flex-wrap gap-2 border border-gray-200 shadow-sm",children:[e.jsx("button",{onClick:()=>G("all"),className:"px-3 py-1 rounded-md text-sm transition-colors "+("all"===n?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"All Time"}),e.jsx("button",{onClick:()=>G("today"),className:"px-3 py-1 rounded-md text-sm transition-colors "+("today"===n?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Today"}),e.jsx("button",{onClick:()=>G("yesterday"),className:"px-3 py-1 rounded-md text-sm transition-colors "+("yesterday"===n?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Yesterday"}),e.jsx("button",{onClick:()=>G("week"),className:"px-3 py-1 rounded-md text-sm transition-colors "+("week"===n?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"This Week"}),e.jsx("button",{onClick:()=>G("month"),className:"px-3 py-1 rounded-md text-sm transition-colors "+("month"===n?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"This Month"}),e.jsx("div",{className:"flex-grow"}),e.jsxs("button",{onClick:()=>G("custom"),className:"flex items-center text-sm px-3 py-1 rounded-md transition-colors "+("custom"===n?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:text-gray-700"),children:[e.jsx(o,{className:"mr-1"}),e.jsx("span",{children:"Custom Range"})]})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Custom Date Range"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:k.startDate,onChange:e=>D({...k,startDate:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",max:(new Date).toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:k.endDate,onChange:e=>D({...k,endDate:e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",min:k.startDate,max:(new Date).toISOString().split("T")[0]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{C(!1),i("all"),D({startDate:"",endDate:""})},className:"px-4 py-2 text-sm border rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>{k.startDate&&k.endDate&&C(!1)},disabled:!k.startDate||!k.endDate,className:"px-4 py-2 bg-indigo-600 text-white text-sm rounded-md hover:bg-indigo-700 disabled:opacity-50",children:"Apply"})]})]})}),K&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active filters:"}),"all"!==A.status&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:["Status: ",A.status,e.jsx("button",{onClick:()=>Y("status","all"),className:"ml-1 hover:text-blue-600",children:e.jsx(d,{className:"h-3 w-3"})})]}),A.executedBy&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:["User: ",A.executedBy,e.jsx("button",{onClick:()=>Y("executedBy",""),className:"ml-1 hover:text-green-600",children:e.jsx(d,{className:"h-3 w-3"})})]}),"all"!==n&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:["Date: ","custom"===n?`${k.startDate} to ${k.endDate}`:n,e.jsx("button",{onClick:()=>G("all"),className:"ml-1 hover:text-purple-600",children:e.jsx(d,{className:"h-3 w-3"})})]}),e.jsx("button",{onClick:J,className:"text-xs text-red-600 hover:text-red-800 ml-2",children:"Clear all"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:r?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]}):0===U.length?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-4 mb-4",children:e.jsx(h,{className:"h-8 w-8 text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No test results found"}),e.jsx("p",{className:"text-gray-500 mb-6 text-center max-w-md",children:K?"No executions match your current filters":"No test executions have been run yet"}),K&&e.jsx("button",{onClick:J,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Clear All Filters"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{results:U,totalResults:L.totalElements,onViewExecution:async e=>{l(!0);try{const t=B.find((t=>t.id===e));if(!t)return void y.error("Execution not found");const s=await(async e=>{try{if(e.testCaseResults&&e.testCaseResults.length>0){const t=e.testCaseResults.map((e=>{const t=e.assertionResults&&Array.isArray(e.assertionResults)?e.assertionResults.map((e=>({id:e.assertionId,name:e.assertionName||"Assertion",type:"custom",status:"PASSED"===e.status?"Passed":"Failed",actualValue:e.actualValue,expectedValue:e.expectedValue,executionTime:e.executionTime||0,..."PASSED"!==e.status&&e.errorMessage&&{error:e.errorMessage}}))):[],s=e.assertionSummary||{total:t.length,passed:t.filter((e=>"Passed"===e.status)).length,failed:t.filter((e=>"Failed"===e.status)).length,skipped:0,successRate:0};let a;if(s.total>0&&!s.successRate&&(s.successRate=Math.round(s.passed/s.total*100)),0===s.total){const t=e.statusCode;a=t>=200&&t<400?"Executed":"Failed"}else a=0===s.failed&&s.passed>0?"Passed":"Failed";return{id:`tc-${e.testCaseId}`,name:e.testCaseName||"API Test Case",status:a,duration:`${e.executionTimeMs}ms`,request:{method:e.httpMethod,url:e.url,headers:e.requestHeaders||{},body:e.requestBody},response:{status:e.statusCode,data:e.responseBody,headers:e.responseHeaders||{}},assertions:t,assertionSummary:s,testSuiteId:e.testSuiteId,testSuiteName:e.testSuiteName,testCaseId:e.testCaseId,resultId:e.resultId}})),s=t.filter((e=>"Passed"===e.status)).length,a=t.filter((e=>"Executed"===e.status)).length,r=t.filter((e=>"Failed"===e.status)).length,l=s+a,n=t.length>0?Math.round(l/t.length*100):0;return{id:e.id,status:e.status,executionStatus:e.executionStatus,instanceId:e.id,executedBy:e.executedBy,environment:e.environmentName,executedAt:e.executedAt,passedCount:s,failedCount:r,executedCount:a,errorCount:e.errorTests,totalTests:t.length,executionTime:e.executionTime,successRate:n,results:t,rawExecutionId:e.executionId}}{const t=await p.getExecutionDetails(e.executionId);if(t&&t.result&&"200"===t.result.code){const s=(t.result.data.testCaseResult||[]).map((e=>{const t=e.assertionResults&&Array.isArray(e.assertionResults)?e.assertionResults.map((e=>({id:e.assertionId,name:e.assertionName||"Assertion",type:"custom",status:"PASSED"===e.status?"Passed":"Failed",actualValue:e.actualValue,expectedValue:e.expectedValue,executionTime:e.executionTime||0,..."PASSED"!==e.status&&e.errorMessage&&{error:e.errorMessage}}))):[],s=e.assertionSummary||{total:t.length,passed:t.filter((e=>"Passed"===e.status)).length,failed:t.filter((e=>"Failed"===e.status)).length,skipped:0,successRate:0};let a;if(s.total>0&&!s.successRate&&(s.successRate=Math.round(s.passed/s.total*100)),0===s.total){const t=e.statusCode;a=t>=200&&t<400?"Executed":"Failed"}else a=0===s.failed&&s.passed>0?"Passed":"Failed";return{id:`tc-${e.testCaseId}`,name:e.testCaseName||"API Test Case",status:a,duration:`${e.executionTimeMs}ms`,request:{method:e.httpMethod,url:e.url,headers:e.requestHeaders||{},body:e.requestBody},response:{status:e.statusCode,data:e.responseBody,headers:e.responseHeaders||{}},assertions:t,assertionSummary:s,testSuiteId:e.testSuiteId,testSuiteName:e.testSuiteName,testCaseId:e.testCaseId,resultId:e.resultId}})),a=s.filter((e=>"Passed"===e.status)).length,r=s.filter((e=>"Executed"===e.status)).length,l=s.filter((e=>"Failed"===e.status)).length,n=a+r,i=s.length>0?Math.round(n/s.length*100):0;return{id:e.id,status:e.status,executionStatus:e.executionStatus,instanceId:e.id,executedBy:e.executedBy,environment:e.environmentName,executedAt:e.executedAt,passedCount:a,failedCount:l,executedCount:r,errorCount:e.errorTests,totalTests:s.length,executionTime:e.executionTime,successRate:i,results:s,rawExecutionId:e.executionId}}return O(e)}}catch(t){return O(e)}})(t);a(s),E("execution")}catch(t){y.error("Failed to load execution details")}finally{l(!1)}},onFilter:e=>Y("status",e),currentPage:M,pageSize:v}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",Math.min((M-1)*v+1,L.totalElements)," to"," ",Math.min(M*v,L.totalElements)," of ",L.totalElements," items"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>Q(M-1),disabled:L.first,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-40 text-gray-600 transition-colors",children:"Previous"}),(()=>{const e=[];e.push(1),M>4&&e.push("...");for(let t=Math.max(2,M-2);t<=Math.min(L.totalPages-1,M+2);t++)e.push(t);return M+2<L.totalPages-1&&e.push("..."),L.totalPages>1&&e.push(L.totalPages),e})().map(((t,s)=>e.jsx("button",{disabled:"..."===t,onClick:()=>"..."!==t&&Q(t),className:`px-3 py-1 border rounded-md ${t===M?"bg-indigo-600 text-white border-indigo-600":"hover:bg-gray-100 text-gray-600"} transition-colors`,children:t},s))),e.jsx("button",{onClick:()=>Q(M+1),disabled:L.last,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-40 text-gray-600 transition-colors",children:"Next"})]})]})]})})]})};export{w as default};
