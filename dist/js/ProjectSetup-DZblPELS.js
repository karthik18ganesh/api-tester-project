import{j as e}from"./chunk-BAZEzdRI.js";import{u as t,r as s}from"./chunk-N8EMqdL-.js";import{u as r,a,b as i,c as d,d as l,e as n,g as o}from"../assets/index-DPPazEPA.js";import{I as c}from"./chunk-BMUbXS5z.js";import{B as m}from"./chunk-CsFuKD-F.js";import"./chunk-JxthdRRf.js";import"./chunk-Bz_K-boV.js";import{B as x}from"./chunk-DuaeYWru.js";import{y as h}from"./chunk-CQIvISRI.js";import{n as p}from"./chunk-BV3C3NLD.js";import"./chunk-MJHYApCa.js";import"./chunk-Cef-BAxw.js";const g=()=>{const g=t(),{activeProject:u,setActiveProject:j,clearActiveProject:b,updateProject:f,removeProject:y}=r(),[N,v]=s.useState([]),[w,C]=s.useState({id:null,name:"",projectId:"",description:""}),[k,D]=s.useState(1),[I,P]=s.useState(!1),[S,E]=s.useState(null),[M,A]=s.useState(!0),[$,z]=s.useState(!1),[L,B]=s.useState(""),T=null!==w.id,F=N.filter((e=>e.name.toLowerCase().includes(L.toLowerCase())||e.projectId.toLowerCase().includes(L.toLowerCase())||e.description.toLowerCase().includes(L.toLowerCase()))),U=Math.ceil(F.length/6),V=F.slice(6*(k-1),6*k),W=async()=>{z(!0);try{const e=await o("/api/v1/projects?pageNo=0&limit=100&sortBy=updatedDate&sortDir=DESC","GET"),{code:t,data:s,message:r}=e.result;if("200"===t){const e=s.content.map((e=>({id:e.id,name:e.projectName,projectId:e.projectId,description:e.description,date:e.createdDate,updatedDate:e.updatedDate})));v(e)}else h.error(r||"Failed to fetch projects")}catch(e){h.error("Error fetching projects")}finally{z(!1)}};return s.useEffect((()=>{W()}),[]),e.jsxs("div",{className:"p-6 font-inter text-gray-800",children:[e.jsx(x,{items:[{label:"Admin Settings"},{label:"Project Setup"}]}),e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Project Setup"})}),e.jsxs("div",{id:"projectForm",className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden transition-all duration-300 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 px-6 py-4 flex justify-between items-center cursor-pointer",onClick:()=>A(!M),children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:T?"Update Project":"Create New Project"}),e.jsx(a,{className:"text-white transition-transform duration-300 transform "+(M?"rotate-180":"")})]}),e.jsx("div",{className:"transition-all duration-300 overflow-hidden "+(M?"max-h-[500px] opacity-100":"max-h-0 opacity-0"),children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),z(!0);const t={requestMetaData:{userId:localStorage.getItem("userId"),transactionId:p(),timestamp:(new Date).toISOString()},data:{id:w.id||null,projectId:w.projectId,projectName:w.name,description:w.description}},s=T?"PUT":"POST";try{const e=await o("/api/v1/projects",s,t),{code:r,message:a}=e.result;if("200"===r){if(h.success(a||(T?"Updated":"Created")),T&&u&&u.id===w.id){const e={...u,name:w.name,projectId:w.projectId,description:w.description};f(e),h.info("Active project details updated")}W(),C({id:null,name:"",projectId:"",description:""})}else h.error(a||"Failed to process project")}catch(r){h.error("Error during submission")}finally{z(!1)}},className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Project Name"}),e.jsx("input",{type:"text",value:w.name,onChange:e=>C((t=>({...t,name:e.target.value}))),className:"w-full border border-gray-300 p-3 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",placeholder:"Enter project name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Project ID"}),e.jsx("input",{type:"text",value:w.projectId,onChange:e=>C((t=>({...t,projectId:e.target.value}))),className:"w-full border border-gray-300 p-3 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",placeholder:"Enter project ID",required:!0})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Description"}),e.jsx("textarea",{rows:3,value:w.description,onChange:e=>C((t=>({...t,description:e.target.value}))),className:"w-full border border-gray-300 p-3 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",placeholder:"Enter project description"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[T&&e.jsx("button",{type:"button",onClick:()=>{C({id:null,name:"",projectId:"",description:""})},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx(m,{type:"submit",className:"flex items-center gap-2",disabled:$,children:$?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):T?"Update Project":"Create Project"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50 flex flex-col md:flex-row justify-between md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Projects"}),u&&e.jsxs("div",{className:"ml-3 bg-indigo-100 text-indigo-800 text-xs py-1 px-2 rounded-full flex items-center",children:[e.jsx("span",{className:"mr-1",children:"Active:"}),e.jsx("span",{className:"font-medium",children:u.name})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(i,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md bg-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Search projects...",value:L,onChange:e=>{B(e.target.value),D(1)}}),L&&e.jsx("button",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>B(""),children:e.jsx(d,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),$&&0===N.length?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[e.jsx("div",{className:"h-8 w-8 bg-indigo-200 rounded-full mb-4",children:e.jsxs("svg",{className:"animate-spin h-8 w-8 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading projects..."})]})}):0===V.length?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-3 mb-4",children:e.jsx(i,{className:"h-6 w-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No projects found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:L?`No projects matching "${L}"`:"Start by creating your first project"}),L&&e.jsxs(m,{onClick:()=>B(""),className:"flex items-center gap-2",children:[e.jsx(d,{size:14}),e.jsx("span",{children:"Clear Search"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b border-gray-200",children:e.jsxs("tr",{className:"align-middle",children:[e.jsx("th",{className:"p-4 font-medium text-center w-24",children:"Status"}),e.jsx("th",{className:"p-4 font-medium w-48",children:"Name"}),e.jsx("th",{className:"p-4 font-medium w-32",children:"Project ID"}),e.jsx("th",{className:"p-4 font-medium w-64",children:"Description"}),e.jsx("th",{className:"p-4 font-medium w-36",children:"Date"}),e.jsx("th",{className:"p-4 text-right font-medium w-32",children:"Actions"})]})}),e.jsx("tbody",{children:V.map(((t,s)=>e.jsxs("tr",{className:`border-b border-gray-200 hover:bg-indigo-50/30 transition-colors align-middle min-h-16 ${s%2==0?"bg-white":"bg-gray-50/50"} ${u&&u.id===t.id?"bg-indigo-50":""}`,children:[e.jsx("td",{className:"p-4 text-center align-middle w-24",children:e.jsxs("button",{onClick:()=>(e=>{j(e),h.success(`Project "${e.name}" set as active`)})(t),className:"relative inline-flex items-center h-6 rounded-full w-11 focus:outline-none transition-colors",title:u&&u.id===t.id?"Current active project":"Set as active project",disabled:u&&u.id===t.id,children:[e.jsx("span",{className:(u&&u.id===t.id?"bg-indigo-600":"bg-gray-200")+" absolute inset-y-0 left-0 w-11 h-6 rounded-full transition-colors"}),e.jsx("span",{className:(u&&u.id===t.id?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})]})}),e.jsx("td",{className:"p-4 font-medium text-indigo-700 align-middle w-48",children:t.name}),e.jsx("td",{className:"p-4 text-gray-600 align-middle w-32",children:t.projectId}),e.jsx("td",{className:"p-4 text-gray-600 align-middle w-64",children:e.jsx("div",{className:"truncate",title:t.description,children:t.description||"No description"})}),e.jsx("td",{className:"p-4 text-gray-500 align-middle w-36",children:e.jsx("div",{className:"truncate",title:`Created: ${t.date}${t.updatedDate&&t.updatedDate!==t.date?` | Updated: ${t.updatedDate}`:""}`,children:t.updatedDate&&t.updatedDate!==t.date?t.updatedDate:t.date})}),e.jsx("td",{className:"p-4 text-right align-middle w-32",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(c,{icon:l,onClick:()=>(C(t),A(!0),void document.getElementById("projectForm").scrollIntoView({behavior:"smooth"})),className:"bg-indigo-100 hover:bg-indigo-200 rounded-md text-indigo-600"}),e.jsx(c,{icon:n,onClick:()=>{E(t),P(!0)},className:"bg-red-100 hover:bg-red-200 rounded-md text-red-600"})]})})]},t.id)))})]})}),e.jsxs("div",{className:"flex justify-between items-center px-4 py-4 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",Math.min(F.length,6*(k-1)+1)," to"," ",Math.min(F.length,6*k)," of ",F.length," projects"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>D((e=>Math.max(e-1,1))),disabled:1===k,className:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-40 disabled:hover:bg-white text-gray-700 transition-colors",children:"Prev"}),(()=>{const e=[];e.push(1),k>4&&e.push("...");for(let t=Math.max(2,k-2);t<=Math.min(U-1,k+2);t++)e.push(t);return k+2<U-1&&e.push("..."),U>1&&e.push(U),e})().map(((t,s)=>e.jsx("button",{disabled:"..."===t,onClick:()=>"..."!==t&&D(t),className:`px-3 py-1 border rounded-md ${t===k?"bg-indigo-600 text-white border-indigo-600":"border-gray-300 hover:bg-gray-100 text-gray-700"} transition-colors`,children:t},s))),e.jsx("button",{onClick:()=>D((e=>Math.min(e+1,U))),disabled:k===U||0===U,className:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-40 disabled:hover:bg-white text-gray-700 transition-colors",children:"Next"})]})]})]})]}),I&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:()=>P(!1),children:e.jsx("div",{className:"absolute inset-0 bg-gray-900 opacity-50"})}),e.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-xl transform transition-all max-w-lg w-full p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:e.jsx(n,{className:"h-6 w-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2 text-center",children:"Delete Project"}),e.jsxs("p",{className:"text-gray-600 text-center",children:["Are you sure you want to delete ",e.jsxs("span",{className:"font-medium text-gray-900",children:['"',S?.name,'"']}),"? This action cannot be undone."]}),u&&u.id===S?.id&&e.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md text-yellow-800 text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:"Warning"}),e.jsx("p",{children:"This is currently set as your active project. Deleting it will remove your active project selection."})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>P(!1),children:"Cancel"}),e.jsx(m,{onClick:async()=>{z(!0);try{const e=await o(`/api/v1/projects/${S.id}`,"DELETE"),{code:t,message:s}=e.result;"200"===t?(y(S.id),u&&u.id===S.id?(h.success(s||"Project deleted. Please select a new active project."),W(),setTimeout((()=>{g("/dashboard")}),1e3)):(h.success(s||"Project deleted"),W())):h.error(s||"Delete failed")}catch(e){h.error("Error deleting project")}finally{z(!1),P(!1)}},className:"bg-red-600 hover:bg-red-700",disabled:$,children:$?e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete"})]})]})]})})]})};export{g as default};
