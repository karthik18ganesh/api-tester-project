import{j as e}from"./chunk-BAZEzdRI.js";import{u as t,r as s}from"./chunk-N8EMqdL-.js";import{h as a,c as r,i as n,j as l,k as i,l as d,m as o,n as c,p as m,g as x}from"../assets/index-C0OMGUoK.js";import{B as h}from"./chunk-C_F5Bpmt.js";import{y as u}from"./chunk-CQIvISRI.js";import{C as g}from"./chunk-DzrcbvBi.js";import{n as p}from"./chunk-BV3C3NLD.js";import"./chunk-MJHYApCa.js";import"./chunk-Cef-BAxw.js";import"./chunk-D8tE5vCa.js";const y=()=>{const y=t(),[f,j]=s.useState(!0),[b,N]=s.useState(null),[v,w]=s.useState([]),[C,k]=s.useState([]),[S,D]=s.useState(0),[I,E]=s.useState(0),[T,M]=s.useState([]),[$,F]=s.useState(!1),[L,P]=s.useState(1),[z,A]=s.useState(!1),[B,H]=s.useState("createdDate"),[R,V]=s.useState("DESC"),[O,q]=s.useState(""),U=()=>({userId:localStorage.getItem("userId")||"302",transactionId:p(),timestamp:(new Date).toISOString()}),W=async()=>{try{j(!0);const e=await x(`/api/v1/test-cases?pageNo=${L-1}&limit=6&sortBy=${B}&sortDir=${R}`);if(!e.result?.data)throw new Error("Unexpected response format");{const t=e.result.data.content.map((e=>({...e,status:e.status||"Pending",executedDate:e.executedDate||"Never"})));w(t),k(t),D(e.result.data.totalPages||0),E(e.result.data.totalElements||0),M([])}}catch(e){N("Failed to load test cases. Please try again later."),u.error("Failed to load test cases")}finally{j(!1)}},G=async e=>{try{const t={requestMetaData:U(),data:{format:e,testCaseIds:T}};await x("/api/v1/test-cases/export","POST",t),u.info(`Exporting ${T.length} test cases as ${e}...`),F(!1)}catch(t){u.error(`Failed to export test cases as ${e}`)}},J=()=>{q(""),k(v)};s.useEffect((()=>{W()}),[L,B,R]);const K=e=>{switch(e.toLowerCase()){case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"in progress":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},Q=e=>{switch(e?.toLowerCase()){case"functional":return"bg-purple-100 text-purple-800";case"performance":return"bg-yellow-100 text-yellow-800";case"security":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"p-6 font-inter text-gray-800",children:[e.jsx(h,{items:[{label:"Test Design"},{label:"Test Case"}]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Test Cases"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Define and manage individual test scenarios for your APIs"})]}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("input",{type:"text",placeholder:"Search test cases...",value:O,onChange:e=>{const t=e.target.value.toLowerCase();if(q(t),t.trim()){const e=v.filter((e=>e.name.toLowerCase().includes(t)||String(e.testCaseId).includes(t)||e.description&&e.description.toLowerCase().includes(t)));k(e)}else k(v);P(1)},className:"w-full px-10 py-2 border rounded-md border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),O&&e.jsx("button",{onClick:J,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 hover:-translate-y-0.5 transition-all",children:e.jsx(r,{})})]})]}),e.jsx("div",{className:"flex justify-end mb-4",children:0===T.length?e.jsxs("button",{onClick:()=>y("/test-design/test-case/create"),className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center",children:[e.jsx(n,{className:"mr-2"}),"Create Test Case"]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("span",{className:"flex items-center px-3 py-1 bg-indigo-50 text-indigo-700 rounded-md",children:[T.length," item",1!==T.length?"s":""," selected"]}),e.jsxs("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 hover:-translate-y-0.5 transition-all flex items-center",children:[e.jsx(l,{className:"mr-2"}),"Delete"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>F(!$),className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center",children:[e.jsx(i,{className:"mr-2"}),"Export"]}),$&&e.jsxs("div",{className:"absolute right-0 mt-2 bg-white border rounded-md shadow-lg w-40 z-10 animate-fade-in",children:[e.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer rounded-t-md flex items-center text-gray-700",onClick:()=>G("PDF"),children:[e.jsxs("svg",{className:"w-5 h-5 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2-1a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V4a1 1 0 00-1-1H6z",clipRule:"evenodd"})]}),"PDF"]}),e.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer rounded-b-md flex items-center text-gray-700 border-t",onClick:()=>G("Excel"),children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-gray-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 5a2 2 0 012-2h10a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V5zm11 1H6v8l4-2 4 2V6z",clipRule:"evenodd"})}),"Excel"]})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:f?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading test cases..."})]}):b?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"bg-red-100 rounded-full p-4 mb-4 text-red-600",children:e.jsx("svg",{className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:b}),e.jsx("button",{className:"mt-4 px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all",onClick:W,children:"Try Again"})]}):0===C.length?e.jsxs("div",{className:"p-8 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-4 mb-4",children:e.jsx(d,{className:"h-8 w-8 text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No test cases found"}),e.jsx("p",{className:"text-gray-500 mb-6 text-center max-w-md",children:O?`No cases match your search "${O}"`:"Create your first test case to start testing your APIs"}),O?e.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 hover:-translate-y-0.5 transition-all flex items-center",onClick:J,children:[e.jsx(r,{className:"mr-2"}),"Clear Search"]}):e.jsxs("button",{className:"px-4 py-2 bg-[#4F46E5] text-white rounded-md hover:bg-indigo-700 hover:-translate-y-0.5 transition-all flex items-center",onClick:()=>y("/test-design/test-case/create"),children:[e.jsx(n,{className:"mr-2"}),"Create Test Case"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 font-medium",children:e.jsx("input",{type:"checkbox",onChange:()=>{const e=C.map((e=>e.testCaseId)),t=e.every((e=>T.includes(e)));M(t?T.filter((t=>!e.includes(t))):[...new Set([...T,...e])])},checked:C.length>0&&C.every((e=>T.includes(e.testCaseId))),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("th",{className:"py-3 px-4 font-medium",children:"ID"}),e.jsx("th",{className:"py-3 px-4 font-medium",children:"Test Case Name"}),e.jsx("th",{className:"py-3 px-4 font-medium",children:"Type"}),e.jsx("th",{className:"py-3 px-4 font-medium",children:"Description"}),e.jsx("th",{className:"py-3 px-4 font-medium",children:"Created"}),e.jsx("th",{className:"py-3 px-4 font-medium",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:C.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",checked:T.includes(t.testCaseId),onChange:()=>{return e=t.testCaseId,void M((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]));var e},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsxs("td",{className:"py-3 px-4 text-gray-600 font-mono text-xs",children:["TC-",String(t.testCaseId).padStart(3,"0")]}),e.jsxs("td",{onClick:()=>y("/test-design/test-case/create",{state:{testCase:t}}),className:"py-3 px-4 text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer flex items-center",children:[t.name,e.jsx(o,{className:"ml-1 h-4 w-4"})]}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Q(t.type)}`,children:t.type||"N/A"})}),e.jsx("td",{className:"py-3 px-4 text-gray-600 truncate max-w-xs",children:t.description||"â€”"}),e.jsxs("td",{className:"py-3 px-4 text-gray-600 flex items-center",children:[e.jsx(c,{className:"mr-1 h-3 w-3 text-gray-400"}),t.createdDate]}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${K(t.status)}`,children:["Completed"===t.status&&e.jsx(m,{className:"mr-1 h-3 w-3"}),t.status]})})]},t.testCaseId)))})]}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",Math.min(6*(L-1)+1,I)," to"," ",Math.min(6*L,I)," of ",I," items"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>P((e=>Math.max(e-1,1))),disabled:1===L,className:"px-3 py-1 border rounded-md hover:bg-gray-100 hover:-translate-y-0.5 disabled:opacity-40 disabled:hover:transform-none text-gray-600 transition-all",children:"Previous"}),(()=>{const e=[];e.push(1),L>4&&e.push("...");for(let t=Math.max(2,L-2);t<=Math.min(S-1,L+2);t++)e.push(t);return L+2<S-1&&e.push("..."),S>1&&e.push(S),e})().map(((t,s)=>e.jsx("button",{disabled:"..."===t,onClick:()=>"..."!==t&&P(t),className:"px-3 py-1 border rounded-md hover:-translate-y-0.5 transition-all "+(t===L?"bg-indigo-600 text-white border-indigo-600":"hover:bg-gray-100 text-gray-600"),children:t},s))),e.jsx("button",{onClick:()=>P((e=>Math.min(e+1,S))),disabled:L===S||0===S,className:"px-3 py-1 border rounded-md hover:bg-gray-100 hover:-translate-y-0.5 disabled:opacity-40 disabled:hover:transform-none text-gray-600 transition-all",children:"Next"})]})]})]})})]}),e.jsx(g,{isOpen:z,onClose:()=>A(!1),onConfirm:async()=>{try{const e={requestMetaData:U(),data:T};await x("/api/v1/test-cases/delete","DELETE",e),u.success(`Successfully deleted ${T.length} test case(s)`),W(),M([]),A(!1)}catch(e){u.error("Failed to delete test cases")}},title:"Delete Test Cases",message:`Are you sure you want to delete ${T.length} selected test case${1!==T.length?"s":""}? This action cannot be undone.`})]})};export{y as default};
